{"version":3,"file":"setGiftOptionsOnCart.js","sources":["/@dropins/storefront-cart/src/api/setGiftOptionsOnCart/graphql/UpdateGiftOptionsMutation.ts","/@dropins/storefront-cart/src/api/setGiftOptionsOnCart/setGiftOptionsOnCart.ts"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { CART_FRAGMENT } from '@/cart/api/graphql/CartFragment';\nimport { CART_ITEMS_PAGINATION_ARGUMENTS } from '@/cart/api/graphql/arguments';\n\nexport const SET_GIFT_OPTIONS_ON_CART_MUTATION = `\n  mutation SET_GIFT_OPTIONS_ON_CART_MUTATION($cartId: String!, $giftMessage: GiftMessageInput, $giftWrappingId: ID, $giftReceiptIncluded: Boolean!, $printedCardIncluded: Boolean!, ${CART_ITEMS_PAGINATION_ARGUMENTS}) {\n setGiftOptionsOnCart(\n    input: {\n     cart_id: $cartId\n     gift_message: $giftMessage\n     gift_wrapping_id: $giftWrappingId\n     gift_receipt_included: $giftReceiptIncluded\n     printed_card_included: $printedCardIncluded\n    }\n  ) {\n    cart {\n      ...CART_FRAGMENT\n    }\n  }\n}\n${CART_FRAGMENT}\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { state } from '@/cart/lib/state';\nimport { fetchGraphQl } from '@/cart/api';\nimport { handleFetchError } from '@/cart/lib/fetch-error';\nimport { CartModel } from '@/cart/data/models';\nimport { transformCart } from '@/cart/data/transforms';\nimport { events } from '@adobe-commerce/event-bus';\nimport { SET_GIFT_OPTIONS_ON_CART_MUTATION } from './graphql/UpdateGiftOptionsMutation';\nimport { publishCartUpdateEvents } from '@/cart/lib/acdl';\nimport { GiftFormDataType } from '@/cart/types';\n\nexport const setGiftOptionsOnCart = async (\n  giftForm: GiftFormDataType\n): Promise<CartModel | null> => {\n  const cartId = state.cartId;\n\n  if (!cartId) {\n    throw Error('Cart ID is not set');\n  }\n\n  const {\n    recipientName,\n    senderName,\n    message,\n    giftReceiptIncluded,\n    printedCardIncluded,\n    giftWrappingId,\n    isGiftWrappingSelected,\n  } = giftForm;\n\n  return fetchGraphQl(SET_GIFT_OPTIONS_ON_CART_MUTATION, {\n    variables: {\n      cartId,\n      giftMessage: {\n        from: senderName,\n        to: recipientName,\n        message,\n      },\n      giftWrappingId: isGiftWrappingSelected ? giftWrappingId : null,\n      giftReceiptIncluded,\n      printedCardIncluded,\n    },\n  }).then(({ errors, data }) => {\n    // handle errors\n    const _errors = [\n      ...(data?.addProductsToCart?.user_errors ?? []),\n      ...(errors ?? []),\n    ];\n\n    if (_errors.length > 0) return handleFetchError(_errors);\n\n    const payload = transformCart(data.setGiftOptionsOnCart.cart);\n\n    // emit events\n    events.emit('cart/updated', payload);\n    events.emit('cart/data', payload);\n\n    if (payload) {\n      publishCartUpdateEvents(payload, [], state.locale ?? 'en-US');\n    }\n\n    return payload;\n  });\n};\n"],"names":["SET_GIFT_OPTIONS_ON_CART_MUTATION","CART_ITEMS_PAGINATION_ARGUMENTS","CART_FRAGMENT","setGiftOptionsOnCart","giftForm","cartId","state","recipientName","senderName","message","giftReceiptIncluded","printedCardIncluded","giftWrappingId","isGiftWrappingSelected","fetchGraphQl","errors","data","_errors","_a","handleFetchError","payload","transformCart","events","publishCartUpdateEvents"],"mappings":"gOAoBO,MAAMA,EAAoC;AAAA,sLACqIC,CAA+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAenNC,CAAa;AAAA,ECTFC,EAAuB,MAClCC,GAC8B,CAC9B,MAAMC,EAASC,EAAM,OAErB,GAAI,CAACD,EACH,MAAM,MAAM,oBAAoB,EAG5B,KAAA,CACJ,cAAAE,EACA,WAAAC,EACA,QAAAC,EACA,oBAAAC,EACA,oBAAAC,EACA,eAAAC,EACA,uBAAAC,CAAA,EACET,EAEJ,OAAOU,EAAad,EAAmC,CACrD,UAAW,CACT,OAAAK,EACA,YAAa,CACX,KAAMG,EACN,GAAID,EACJ,QAAAE,CACF,EACA,eAAgBI,EAAyBD,EAAiB,KAC1D,oBAAAF,EACA,oBAAAC,CAAA,CAEH,CAAA,EAAE,KAAK,CAAC,CAAE,OAAAI,EAAQ,KAAAC,KAAW,OAE5B,MAAMC,EAAU,CACd,KAAIC,EAAAF,GAAA,YAAAA,EAAM,oBAAN,YAAAE,EAAyB,cAAe,CAAC,EAC7C,GAAIH,GAAU,CAAA,CAChB,EAEA,GAAIE,EAAQ,OAAS,EAAG,OAAOE,EAAiBF,CAAO,EAEvD,MAAMG,EAAUC,EAAcL,EAAK,qBAAqB,IAAI,EAGrD,OAAAM,EAAA,KAAK,eAAgBF,CAAO,EAC5BE,EAAA,KAAK,YAAaF,CAAO,EAE5BA,GACFG,EAAwBH,EAAS,CAAA,EAAId,EAAM,QAAU,OAAO,EAGvDc,CAAA,CACR,CACH"}