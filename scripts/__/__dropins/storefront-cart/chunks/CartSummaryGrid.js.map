{"version":3,"file":"CartSummaryGrid.js","sources":["/@dropins/storefront-cart/src/components/CartSummaryGrid/CartSummaryGrid.tsx","/@dropins/storefront-cart/src/containers/CartSummaryGrid/CartSummaryGrid.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { FunctionComponent, VNode } from 'preact';\nimport { HTMLAttributes } from 'preact/compat';\nimport { VComponent, classes } from '@adobe-commerce/elsie/lib';\nimport '@/cart/components/CartSummaryGrid/CartSummaryGrid.css';\nexport interface CartSummaryGridProps extends HTMLAttributes<HTMLDivElement> {\n  products?: VNode | null;\n  emptyCart: VNode;\n}\n\nexport const CartSummaryGrid: FunctionComponent<CartSummaryGridProps> = ({\n  className,\n  children,\n  emptyCart,\n  products,\n  ...props\n}) => {\n  return (\n    <div {...props} className={classes(['cart-cart-summary-grid', className])}>\n      <>\n        <div\n          className={classes([\n            'cart-cart-summary-grid__content',\n            ['cart-cart-summary-grid__content--empty', !products],\n          ])}\n        >\n          {products || (\n            <VComponent\n              node={emptyCart}\n              className=\"cart-cart-summary-grid__empty-cart\"\n            />\n          )}\n        </div>\n      </>\n    </div>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { HTMLAttributes, useEffect, useState } from 'preact/compat';\nimport {\n  CartSummaryGrid as CartSummaryGridComponent,\n  EmptyCart,\n} from '@/cart/components';\nimport { CartModel } from '@/cart/data/models';\nimport { VNode } from 'preact';\nimport { Container, Slot, SlotProps } from '@adobe-commerce/elsie/lib';\nimport { events } from '@adobe-commerce/event-bus';\nimport { Image, ImageProps } from '@adobe-commerce/elsie/components';\nimport { getPersistedCartData } from '@/cart/lib/persisted-data';\n\nexport interface CartSummaryGridProps extends HTMLAttributes<HTMLDivElement> {\n  routeProduct?: (item: CartModel['items'][0]) => string;\n  routeEmptyCartCTA?: () => string;\n  slots?: {\n    Thumbnail?: SlotProps<{ \n      item: CartModel['items'][number], \n      defaultImageProps: ImageProps \n    }>;\n  };\n}\n\nexport const CartSummaryGrid: Container<\n  CartSummaryGridProps,\n  CartModel | null\n> = ({\n  children,\n  initialData = null,\n  routeProduct,\n  routeEmptyCartCTA,\n  slots,\n  ...props\n}) => {\n  const [data, setData] = useState<CartModel | null>(initialData);\n\n  useEffect(() => {\n    const dataEvent = events.on(\n      'cart/data',\n      (payload) => {\n        setData(payload as CartModel);\n      },\n      { eager: true }\n    );\n    return () => {\n      dataEvent?.off();\n    };\n  }, []);\n\n  const getImage = (item: CartModel['items'][0], index: number) => {\n    const handleAriaLabel = item.selectedOptions\n      ? `${item.name}: ${Object.entries(item.selectedOptions).join('; ')}`\n      : item.name;\n\n    const defaultImageProps: ImageProps = {\n      loading: index < 4 ? 'eager' : 'lazy',\n      src: item.image.src,\n      alt: item.image.alt,\n    };\n\n    const imageComponent = (\n      <Image\n        data-testid=\"cart-grid-item-image\"\n        aria-label={handleAriaLabel}\n        width={'100%'}\n        {...defaultImageProps}\n      />\n    );\n\n    return (\n      <div className=\"cart-cart-summary-grid__item-container\" key={index}>\n        <Slot name=\"Thumbnail\" slot={slots?.Thumbnail} context={{ item, defaultImageProps }}>\n          {routeProduct ? (\n              <a href={routeProduct(item)}>{imageComponent}</a>\n            ) : (\n              imageComponent\n            )}\n        </Slot>\n      </div>\n    );\n  };\n\n  const products =\n    data &&\n    ((\n      <>\n        {data.items.map((item, index) => {\n          return getImage(item, index) as VNode;\n        })}\n      </>\n    ) as VNode | null);\n\n  return (\n    <CartSummaryGridComponent\n      {...props}\n      emptyCart={\n        <EmptyCart\n          ctaLinkURL={routeEmptyCartCTA ? routeEmptyCartCTA() : undefined}\n        />\n      }\n      products={products}\n    />\n  );\n};\n\nCartSummaryGrid.getInitialData = async function () {\n  return getPersistedCartData();\n};\n"],"names":["CartSummaryGrid","className","children","emptyCart","products","props","jsx","classes","Fragment","VComponent","initialData","routeProduct","routeEmptyCartCTA","slots","data","setData","useState","useEffect","dataEvent","events","payload","getImage","item","index","handleAriaLabel","defaultImageProps","imageComponent","Image","Slot","CartSummaryGridComponent","EmptyCart","getPersistedCartData"],"mappings":"udA0BO,MAAMA,EAA2D,CAAC,CACvE,UAAAC,EACA,SAAAC,EACA,UAAAC,EACA,SAAAC,EACA,GAAGC,CACL,IAEIC,EAAC,MAAK,CAAA,GAAGD,EAAO,UAAWE,EAAQ,CAAC,yBAA0BN,CAAS,CAAC,EACtE,SACEK,EAAAE,EAAA,CAAA,SAAAF,EAAC,MAAA,CACC,UAAWC,EAAQ,CACjB,kCACA,CAAC,yCAA0C,CAACH,CAAQ,CAAA,CACrD,EAEA,SACCA,GAAAE,EAACG,EAAA,CACC,KAAMN,EACN,UAAU,oCAAA,CAAA,CACZ,GAGN,CACF,CAAA,ECVSH,EAGT,CAAC,CACH,SAAAE,EACA,YAAAQ,EAAc,KACd,aAAAC,EACA,kBAAAC,EACA,MAAAC,EACA,GAAGR,CACL,IAAM,CACJ,KAAM,CAACS,EAAMC,CAAO,EAAIC,EAA2BN,CAAW,EAE9DO,EAAU,IAAM,CACd,MAAMC,EAAYC,EAAO,GACvB,YACCC,GAAY,CACXL,EAAQK,CAAoB,CAC9B,EACA,CAAE,MAAO,EAAK,CAChB,EACA,MAAO,IAAM,CACXF,GAAA,MAAAA,EAAW,KACb,CACF,EAAG,EAAE,EAEC,MAAAG,EAAW,CAACC,EAA6BC,IAAkB,CAC/D,MAAMC,EAAkBF,EAAK,gBACzB,GAAGA,EAAK,IAAI,KAAK,OAAO,QAAQA,EAAK,eAAe,EAAE,KAAK,IAAI,CAAC,GAChEA,EAAK,KAEHG,EAAgC,CACpC,QAASF,EAAQ,EAAI,QAAU,OAC/B,IAAKD,EAAK,MAAM,IAChB,IAAKA,EAAK,MAAM,GAClB,EAEMI,EACJpB,EAACqB,EAAA,CACC,cAAY,uBACZ,aAAYH,EACZ,MAAO,OACN,GAAGC,CAAA,CACN,EAIA,OAAAnB,EAAC,MAAI,CAAA,UAAU,yCACb,SAAAA,EAACsB,EAAK,CAAA,KAAK,YAAY,KAAMf,GAAA,YAAAA,EAAO,UAAW,QAAS,CAAE,KAAAS,EAAM,kBAAAG,CAC7D,EAAA,SAAAd,EACIL,EAAA,IAAA,CAAE,KAAMK,EAAaW,CAAI,EAAI,SAAeI,CAAA,CAAA,EAE7CA,CAEN,CAAA,CAAA,EAP2DH,CAQ7D,CAEJ,EAEMnB,EACJU,GAGKR,EAAAE,EAAA,CAAA,SAAAM,EAAK,MAAM,IAAI,CAACQ,EAAMC,IACdF,EAASC,EAAMC,CAAK,CAC5B,EACH,EAIF,OAAAjB,EAACuB,EAAA,CACE,GAAGxB,EACJ,UACEC,EAACwB,EAAA,CACC,WAAYlB,EAAoBA,IAAsB,MAAA,CACxD,EAEF,SAAAR,CAAA,CACF,CAEJ,EAEAJ,EAAgB,eAAiB,gBAAkB,CACjD,OAAO+B,EAAqB,CAC9B"}