{"version":3,"file":"OrderSummary.js","sources":["/@dropins/storefront-cart/src/components/OrderSummary/OrderSummary.tsx","/@dropins/storefront-cart/src/hooks/useEstimatedTotals.tsx","/@dropins/storefront-cart/src/containers/OrderSummary/OrderSummary.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { FunctionComponent, VNode } from 'preact';\nimport { HTMLAttributes, useState } from 'preact/compat';\nimport { classes, VComponent } from '@adobe-commerce/elsie/lib';\nimport '@/cart/components/OrderSummary/OrderSummary.css';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { ChevronDown, ChevronUp } from '@adobe-commerce/elsie/icons';\nimport {\n  Accordion,\n  AccordionSection,\n  Divider,\n  ProgressSpinner,\n} from '@adobe-commerce/elsie/components';\nimport { JSXInternal } from 'preact/src/jsx';\nimport { OrderSummaryLine } from '@/cart/containers/OrderSummaryLine/OrderSummaryLine';\n\nexport interface OrderSummaryLineItem {\n  key: string;\n  title?: string;\n  className?: string;\n  sortOrder: number;\n  content:\n    | string\n    | JSXInternal.Element\n    | VNode<HTMLAttributes<HTMLDivElement>>\n    | OrderSummaryLineItem[]\n    | undefined;\n}\n\nexport interface OrderSummaryProps\n  extends Omit<HTMLAttributes<HTMLDivElement>, 'loading'> {\n  variant?: 'primary' | 'secondary';\n  heading?: VNode<HTMLAttributes<HTMLDivElement>>;\n  loading?: boolean;\n  subTotal?: {\n    price: VNode<HTMLAttributes<HTMLSpanElement>>;\n    priceExcludingTax?: VNode<HTMLAttributes<HTMLSpanElement>>;\n    taxIncluded?: boolean;\n    taxExcluded?: boolean;\n    zeroTaxSubtotal?: boolean;\n  };\n  shipping?: VNode<HTMLAttributes<HTMLDivElement>>;\n  discounts?: {\n    label: string;\n    price: VNode<HTMLAttributes<HTMLSpanElement>>;\n    caption?: VNode<HTMLAttributes<HTMLDivElement>>;\n    coupon?: VNode<HTMLAttributes<HTMLSpanElement>>;\n  }[];\n  taxTotal?: {\n    price: VNode<HTMLAttributes<HTMLSpanElement>>;\n    estimated?: boolean;\n  };\n  taxesApplied?: {\n    label: string;\n    price: VNode<HTMLAttributes<HTMLSpanElement>>;\n  }[];\n  total?: {\n    price: VNode<HTMLAttributes<HTMLSpanElement>>;\n    estimated?: boolean;\n    priceWithoutTax?: VNode<HTMLAttributes<HTMLSpanElement>>;\n  };\n  printedCard?: {\n    renderContent: boolean;\n    taxIncluded: boolean;\n    taxInclAndExcl: boolean;\n    priceExclTax: VNode<HTMLAttributes<HTMLSpanElement>>;\n    priceInclTax: VNode<HTMLAttributes<HTMLSpanElement>>;\n  };\n  itemsGiftWrapping?: {\n    renderContent: boolean;\n    taxIncluded: boolean;\n    taxInclAndExcl: boolean;\n    priceExclTax: VNode<HTMLAttributes<HTMLSpanElement>>;\n    priceInclTax: VNode<HTMLAttributes<HTMLSpanElement>>;\n  };\n  orderGiftWrapping?: {\n    renderContent: boolean;\n    taxIncluded: boolean;\n    taxInclAndExcl: boolean;\n    priceExclTax: VNode<HTMLAttributes<HTMLSpanElement>>;\n    priceInclTax: VNode<HTMLAttributes<HTMLSpanElement>>;\n  };\n  primaryAction?: VNode<HTMLAttributes<HTMLButtonElement>>;\n  coupons?: VNode<HTMLAttributes<HTMLDivElement>>;\n  giftCards?: VNode<HTMLAttributes<HTMLDivElement>>;\n  totalSaved?: VNode<HTMLAttributes<HTMLSpanElement>>;\n  appliedGiftCards?: {\n    label: VNode<HTMLAttributes<HTMLSpanElement>> | string;\n    price: VNode<HTMLAttributes<HTMLSpanElement>>;\n    content?: VNode[];\n  };\n  updateLineItems?: (\n    lineItems: Array<OrderSummaryLineItem>\n  ) => Array<OrderSummaryLineItem>;\n}\n\nexport const OrderSummary: FunctionComponent<OrderSummaryProps> = ({\n  className,\n  children,\n  variant = 'primary',\n  heading,\n  loading = true,\n  subTotal,\n  shipping,\n  discounts,\n  taxTotal,\n  taxesApplied,\n  total,\n  primaryAction,\n  coupons,\n  giftCards,\n  totalSaved,\n  appliedGiftCards,\n  printedCard,\n  itemsGiftWrapping,\n  orderGiftWrapping,\n  updateLineItems = (lineItems) => lineItems,\n  ...props\n}) => {\n  const [showTaxBreakdown, setShowTaxBreakdown] = useState(false);\n\n  const translations = useText({\n    checkout: 'Cart.PriceSummary.checkout',\n    discountedPrice: 'Cart.CartItem.discountedPrice',\n    download: 'Cart.CartItem.download',\n    heading: 'Cart.Cart.heading',\n    message: 'Cart.CartItem.message',\n    regularPrice: 'Cart.CartItem.regularPrice',\n    recipient: 'Cart.CartItem.recipient',\n    sender: 'Cart.CartItem.sender',\n    file: 'Cart.CartItem.file',\n    files: 'Cart.CartItem.files',\n\n    orderSummary: 'Cart.PriceSummary.orderSummary',\n    // Taxes\n    taxesBreakdownTitle: 'Cart.PriceSummary.taxes.breakdown',\n    taxTotal: 'Cart.PriceSummary.taxes.total',\n    taxEstimated: 'Cart.PriceSummary.taxes.estimated',\n    taxTotalOnly: 'Cart.PriceSummary.taxes.totalOnly',\n    showTaxBreakdown: 'Cart.PriceSummary.taxes.showBreakdown',\n    hideTaxBreakdown: 'Cart.PriceSummary.taxes.hideBreakdown',\n    taxToBeDetermined: 'Cart.PriceSummary.taxToBeDetermined',\n\n    // Subtotal\n    subtotalLabel: 'Cart.PriceSummary.subTotal.label',\n    subtotalWithTaxes: 'Cart.PriceSummary.subTotal.withTaxes',\n    subtotalWithoutTaxes: 'Cart.PriceSummary.subTotal.withoutTaxes',\n\n    // Total\n    totalEstimated: 'Cart.PriceSummary.total.estimated',\n    totalLabel: 'Cart.PriceSummary.total.label',\n    totalWithoutTax: 'Cart.PriceSummary.total.withoutTax',\n    totalSaved: 'Cart.PriceSummary.total.saved',\n\n    // Shipping\n    shippingLabel: 'Cart.PriceSummary.shipping.label',\n    zipPlaceholder: 'Cart.PriceSummary.shipping.zipPlaceholder',\n    editZipAction: 'Cart.PriceSummary.shipping.editZipAction',\n    shippingWithTaxes: 'Cart.PriceSummary.shipping.withTaxes',\n    shippingWithoutTaxes: 'Cart.PriceSummary.shipping.withoutTaxes',\n    shippingEstimated: 'Cart.PriceSummary.shipping.estimated',\n    shippingEstimatedByState: 'Cart.PriceSummary.shipping.alternateField.state',\n    shippingEstimatedByZip: 'Cart.PriceSummary.shipping.alternateField.zip',\n    destinationLinkAriaLabel:\n      'Cart.PriceSummary.shipping.destinationLinkAriaLabel',\n    applyButton: 'Cart.PriceSummary.estimatedShippingForm.apply.label',\n    countryField: 'Cart.PriceSummary.estimatedShippingForm.country.placeholder',\n    freeShipping: 'Cart.PriceSummary.freeShipping',\n    stateField: 'Cart.PriceSummary.estimatedShippingForm.state.placeholder',\n    zipField: 'Cart.PriceSummary.estimatedShippingForm.zip.placeholder',\n\n    // Printed Card\n    printedCardTitle: 'Cart.PriceSummary.giftOptionsTax.printedCard.title',\n    printedCardInclTax: 'Cart.PriceSummary.giftOptionsTax.printedCard.inclTax',\n    printedCardExclTax: 'Cart.PriceSummary.giftOptionsTax.printedCard.exclTax',\n\n    // Gift Wrapping Item\n    itemGiftWrappingTitle:\n      'Cart.PriceSummary.giftOptionsTax.itemGiftWrapping.title',\n    itemGiftWrappingInclTax:\n      'Cart.PriceSummary.giftOptionsTax.itemGiftWrapping.inclTax',\n    itemGiftWrappingExclTax:\n      'Cart.PriceSummary.giftOptionsTax.itemGiftWrapping.exclTax',\n\n    // Gift Wrapping Order\n    orderGiftWrappingTitle:\n      'Cart.PriceSummary.giftOptionsTax.orderGiftWrapping.title',\n    orderGiftWrappingInclTax:\n      'Cart.PriceSummary.giftOptionsTax.orderGiftWrapping.inclTax',\n    orderGiftWrappingExclTax:\n      'Cart.PriceSummary.giftOptionsTax.orderGiftWrapping.exclTax',\n  });\n\n  const appliedGiftCardsContent = appliedGiftCards ? (\n    <OrderSummaryLine\n      key={appliedGiftCards?.label}\n      label={appliedGiftCards?.label}\n      price={appliedGiftCards?.price}\n      classSuffixes={['applied-gift-cards']}\n    >\n      {appliedGiftCards?.content}\n    </OrderSummaryLine>\n  ) : null;\n\n  const subTotalContent = subTotal && (\n    <OrderSummaryLine\n      key={translations.subtotalLabel}\n      label={translations.subtotalLabel}\n      price={subTotal.price}\n      classSuffixes={['subTotal']}\n    >\n      {subTotal.taxIncluded && (\n        <div\n          data-testid=\"sub-total-tax-caption\"\n          className=\"cart-order-summary__caption\"\n        >\n          <span>{translations.subtotalWithTaxes}</span>\n        </div>\n      )}\n\n      {subTotal.taxExcluded ? (\n        <div\n          data-testid=\"sub-total-tax-caption-excluded\"\n          className=\"cart-order-summary__caption\"\n        >\n          <span>\n            {subTotal.priceExcludingTax}\n            &nbsp;\n            {translations.subtotalWithoutTaxes}\n          </span>\n        </div>\n      ) : undefined}\n    </OrderSummaryLine>\n  );\n\n  const discountsContent = discounts && discounts.length > 0 && (\n    <>\n      {discounts.map((discount) => (\n        <OrderSummaryLine\n          key={discount.label}\n          label={discount.label}\n          price={discount.price}\n          classSuffixes={['discount']}\n        >\n          {discount.coupon && (\n            <VComponent\n              node={discount.coupon}\n              className=\"cart-order-summary__coupon__code\"\n            />\n          )}\n\n          {discount.caption && (\n            <VComponent\n              node={discount.caption}\n              className=\"cart-order-summary__caption\"\n            />\n          )}\n        </OrderSummaryLine>\n      ))}\n    </>\n  );\n\n  const taxContent =\n    taxesApplied && taxesApplied.length > 0 ? (\n      /* Show breakdown if provided */\n      <Accordion\n        data-testid=\"tax-breakdown\"\n        className=\"cart-order-summary__taxes\"\n        iconOpen={ChevronDown}\n        iconClose={ChevronUp}\n      >\n        <AccordionSection\n          title={translations.taxesBreakdownTitle}\n          secondaryText={\n            !showTaxBreakdown && taxTotal ? (\n              <VComponent\n                node={taxTotal.price}\n                className=\"cart-order-summary__price\"\n              />\n            ) : undefined\n          }\n          renderContentWhenClosed={false}\n          onStateChange={setShowTaxBreakdown}\n        >\n          <div className=\"cart-order-summary__appliedTaxes\">\n            {taxesApplied.map((tax) => (\n              <OrderSummaryLine\n                key={tax.label}\n                label={tax.label}\n                price={tax.price}\n                classSuffixes={['taxEntry']}\n                labelClassSuffix=\"muted\"\n              />\n            ))}\n          </div>\n\n          {taxTotal && (\n            <OrderSummaryLine\n              label={translations.taxTotal}\n              price={taxTotal.price}\n              classSuffixes={['taxTotal']}\n              labelClassSuffix=\"muted\"\n            />\n          )}\n        </AccordionSection>\n      </Accordion>\n    ) : (\n      taxTotal && (\n        <OrderSummaryLine\n          label={\n            taxTotal.estimated\n              ? translations.taxEstimated\n              : translations.taxTotalOnly\n          }\n          price={taxTotal.price}\n          classSuffixes={['taxTotal']}\n          testId=\"tax-total-only\"\n        />\n      )\n    );\n\n  const printedCardContent = printedCard?.renderContent ? (\n    <OrderSummaryLine\n      key={translations.printedCardTitle}\n      label={translations.printedCardTitle}\n      price={\n        printedCard.taxInclAndExcl || printedCard.taxIncluded\n          ? printedCard.priceInclTax\n          : printedCard.priceExclTax\n      }\n      classSuffixes={['printedCardContent']}\n    >\n      {printedCard.taxIncluded && (\n        <div\n          data-testid=\"printed-card-incl\"\n          className=\"cart-order-summary__caption\"\n        >\n          <span>{translations.printedCardInclTax}</span>\n        </div>\n      )}\n\n      {printedCard.taxInclAndExcl ? (\n        <div\n          data-testid=\"printed-card-incl-excl\"\n          className=\"cart-order-summary__caption\"\n        >\n          <span>\n            {printedCard.priceExclTax}\n            &nbsp;\n            {translations.printedCardExclTax}\n          </span>\n        </div>\n      ) : undefined}\n    </OrderSummaryLine>\n  ) : null;\n\n  const itemsGiftWrappingContent = itemsGiftWrapping?.renderContent ? (\n    <OrderSummaryLine\n      key={translations.itemGiftWrappingTitle}\n      label={translations.itemGiftWrappingTitle}\n      price={\n        itemsGiftWrapping.taxInclAndExcl || itemsGiftWrapping.taxIncluded\n          ? itemsGiftWrapping.priceInclTax\n          : itemsGiftWrapping.priceExclTax\n      }\n      classSuffixes={['itemsGiftWrappingContent']}\n    >\n      {itemsGiftWrapping.taxIncluded ? (\n        <div\n          data-testid=\"item-gift-wrapping-incl\"\n          className=\"cart-order-summary__caption\"\n        >\n          <span>{translations.itemGiftWrappingInclTax}</span>\n        </div>\n      ) : null}\n\n      {itemsGiftWrapping.taxInclAndExcl ? (\n        <div\n          data-testid=\"item-gift-wrapping-incl-excl\"\n          className=\"cart-order-summary__caption\"\n        >\n          <span>\n            {itemsGiftWrapping.priceExclTax}\n            &nbsp;\n            {translations.itemGiftWrappingExclTax}\n          </span>\n        </div>\n      ) : null}\n    </OrderSummaryLine>\n  ) : null;\n\n  const orderGiftWrappingContent = orderGiftWrapping?.renderContent ? (\n    <OrderSummaryLine\n      key={translations.orderGiftWrappingTitle}\n      label={translations.orderGiftWrappingTitle}\n      price={\n        orderGiftWrapping.taxInclAndExcl || orderGiftWrapping.taxIncluded\n          ? orderGiftWrapping.priceInclTax\n          : orderGiftWrapping.priceExclTax\n      }\n      classSuffixes={['orderGiftWrappingContent']}\n    >\n      {orderGiftWrapping.taxIncluded && (\n        <div\n          data-testid=\"order-gift-wrapping-incl\"\n          className=\"cart-order-summary__caption\"\n        >\n          <span>{translations.orderGiftWrappingInclTax}</span>\n        </div>\n      )}\n\n      {orderGiftWrapping.taxInclAndExcl ? (\n        <div\n          data-testid=\"order-gift-wrapping-incl-excl\"\n          className=\"cart-order-summary__caption\"\n        >\n          <span>\n            {orderGiftWrapping.priceExclTax}\n            &nbsp;\n            {translations.orderGiftWrappingExclTax}\n          </span>\n        </div>\n      ) : undefined}\n    </OrderSummaryLine>\n  ) : null;\n\n  const lineItems: Array<OrderSummaryLineItem> = [\n    {\n      key: 'subTotalContent',\n      sortOrder: 100,\n      content: subTotalContent,\n    },\n    ...(shipping\n      ? [\n          {\n            key: 'shippingContent',\n            sortOrder: 200,\n            content: (\n              <VComponent\n                node={shipping}\n                className=\"cart-order-summary__shipping\"\n              />\n            ),\n          },\n        ]\n      : []),\n    {\n      key: 'printedCard',\n      sortOrder: 300,\n      content: printedCardContent,\n    },\n    {\n      key: 'itemsGiftWrappingContent',\n      sortOrder: 400,\n      content: itemsGiftWrappingContent,\n    },\n    {\n      key: 'orderGiftWrappingContent',\n      sortOrder: 500,\n      content: orderGiftWrappingContent,\n    },\n    {\n      key: 'discountsContent',\n      sortOrder: 600,\n      content: discountsContent,\n    },\n    {\n      key: 'appliedGiftCardsContent',\n      sortOrder: 700,\n      content: appliedGiftCardsContent,\n    },\n    {\n      key: 'taxContent',\n      sortOrder: 800,\n      content: taxContent,\n    },\n    ...(total\n      ? [\n          {\n            key: 'taxContent',\n            sortOrder: 900,\n            content: (\n              <OrderSummaryLine\n                label={\n                  total.estimated\n                    ? translations.totalEstimated\n                    : translations.totalLabel\n                }\n                price={total.price}\n                classSuffixes={['total', 'total--padded']}\n                testId=\"total-content\"\n                labelClassSuffix=\"bold\"\n              />\n            ),\n          },\n        ]\n      : []),\n    ...(total?.priceWithoutTax\n      ? [\n          {\n            key: 'totalWithoutTaxContent',\n            sortOrder: 1000,\n            content: (\n              <OrderSummaryLine\n                label={translations.totalWithoutTax}\n                price={total.priceWithoutTax}\n                classSuffixes={['totalWithoutTax']}\n                testId=\"total-without-tax\"\n                labelClassSuffix=\"muted\"\n              />\n            ),\n          },\n        ]\n      : []),\n    ...(totalSaved\n      ? [\n          {\n            key: 'totalSavedContent',\n            sortOrder: 1100,\n            content: (\n              <OrderSummaryLine\n                label={translations.totalSaved}\n                price={totalSaved}\n                classSuffixes={['saved']}\n                testId=\"total-saved\"\n                labelClassSuffix=\"muted\"\n              />\n            ),\n          },\n        ]\n      : []),\n    ...(primaryAction\n      ? [\n          {\n            key: 'primaryActionContent',\n            sortOrder: 1200,\n            content: (\n              <div\n                className={classes([\n                  'cart-order-summary__entry',\n                  'cart-order-summary__primaryAction',\n                ])}\n              >\n                {primaryAction}\n              </div>\n            ),\n          },\n        ]\n      : []),\n    ...(coupons\n      ? [\n          {\n            key: 'couponsContent',\n            sortOrder: 1300,\n            content: (\n              <VComponent\n                node={coupons}\n                className=\"cart-order-summary__coupons\"\n              />\n            ),\n          },\n        ]\n      : []),\n    ...(giftCards\n      ? [\n          {\n            key: 'giftCardsContent',\n            sortOrder: 1400,\n            content: (\n              <VComponent\n                node={giftCards}\n                className=\"cart-order-summary__gift-cards\"\n              />\n            ),\n          },\n        ]\n      : []),\n  ];\n\n  const updatedLineItems: Array<OrderSummaryLineItem> = updateLineItems(\n    lineItems\n  ).sort(\n    (currentLine: OrderSummaryLineItem, nextLine: OrderSummaryLineItem) => {\n      return currentLine.sortOrder - nextLine.sortOrder;\n    }\n  );\n\n  return (\n    <div\n      {...props}\n      className={classes([\n        'cart-order-summary',\n        ['cart-order-summary--loading', loading],\n        [`cart-order-summary__${variant}`, variant],\n        className,\n      ])}\n    >\n      {loading && <ProgressSpinner className=\"cart-order-summary__spinner\" />}\n\n      <div className=\"cart-order-summary__heading\">\n        {heading && (\n          <VComponent\n            node={heading}\n            className=\"cart-order-summary__heading-text\"\n          />\n        )}\n\n        <Divider\n          variant=\"primary\"\n          className=\"cart-order-summary__divider-primary\"\n        />\n      </div>\n\n      <div className=\"cart-order-summary__content\">\n        {updatedLineItems.map((line: OrderSummaryLineItem) => {\n          if (Array.isArray(line.content)) {\n            return (\n              <Accordion\n                key={line.key}\n                className={line.className}\n                actionIconPosition={'right'}\n                iconOpen={ChevronDown}\n                iconClose={ChevronUp}\n              >\n                <AccordionSection\n                  defaultOpen={false}\n                  title={line.title}\n                  renderContentWhenClosed={false}\n                >\n                  {line.content.map((innerLine) => {\n                    return innerLine.content;\n                  })}\n                </AccordionSection>\n              </Accordion>\n            );\n          }\n          return line.content;\n        })}\n      </div>\n    </div>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { useState } from 'preact/compat';\nimport { PriceProps } from '@adobe-commerce/elsie/components';\n\nimport { getEstimatedTotals } from '@/cart/api';\n\nexport const useEstimatedTotals = () => {\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const [estimatedTotals, setEstimatedTotals] = useState<any>();\n\n  const handleEstimateTotals = (\n    formValues: {\n      shippingCountry: string;\n      shippingState?: string;\n      shippingStateId?: number;\n      shippingZip?: string;\n    },\n    shippingMethods?: {\n      carrier_code: string;\n      method_code: string;\n    }\n  ) => {\n    setLoading(true);\n\n    const {\n      shippingCountry,\n      shippingState = '',\n      shippingStateId,\n      shippingZip = '',\n    } = formValues;\n\n    const inputData = {\n      countryCode: shippingCountry,\n      postcode: shippingZip,\n      region: {\n        region: shippingState,\n        id: shippingStateId,\n      },\n      shipping_method: {\n        carrier_code: shippingMethods?.carrier_code || '',\n        method_code: shippingMethods?.method_code || '',\n      },\n    };\n\n    getEstimatedTotals(inputData)\n      .then((data) => {\n        if (data) {\n          setEstimatedTotals({\n            estimatedTaxTotal: {\n              amount: data.totalTax?.value,\n              currency: data.totalTax?.currency,\n            },\n            estimatedSubTotal: {\n              excludingTax: {\n                amount: data.subtotal?.excludingTax?.value,\n                currency: data.subtotal?.excludingTax?.currency,\n              },\n              includingTax: {\n                amount: data.subtotal?.includingTax?.value,\n                currency: data.subtotal?.includingTax?.currency,\n              },\n              includingDiscountOnly: {\n                amount: data.subtotal?.includingDiscountOnly?.value,\n                currency: data.subtotal?.includingDiscountOnly?.currency,\n              },\n            },\n            estimatedGrandTotalPrice: {\n              includingTax: {\n                amount: data.total?.includingTax.value,\n                currency: data.total?.includingTax.currency,\n              },\n              excludingTax: {\n                amount: data.total?.excludingTax.value,\n                currency: data.total?.excludingTax.currency,\n              },\n            },\n            estimatedAppliedTaxes: {\n              taxes: data.appliedTaxes?.map((tax) => {\n                return {\n                  label: tax.label,\n                  amount: {\n                    value: tax.amount?.value,\n                    currency: tax.amount?.currency,\n                  },\n                };\n              }),\n            },\n            estimatedItems: {\n              items: data.items?.map((item) => {\n                return {\n                  uid: item.uid,\n                  price: {\n                    amount: item.price?.value,\n                    currency: item.price?.currency,\n                  },\n                  taxedPrice: {\n                    amount: item.taxedPrice?.value,\n                    currency: item.taxedPrice?.currency,\n                  },\n                  rowTotal: {\n                    amount: item.rowTotal?.value,\n                    currency: item.rowTotal?.currency,\n                  },\n                  rowTotalIncludingTax: {\n                    amount: item.rowTotalIncludingTax?.value,\n                    currency: item.rowTotalIncludingTax?.currency,\n                  },\n                  regularPrice: {\n                    amount: item.regularPrice?.value,\n                    currency: item.regularPrice?.currency,\n                  },\n                };\n              }),\n            },\n          } as PriceProps);\n        }\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n\n  return {\n    handleEstimateTotals,\n    estimatedTotals,\n    setEstimatedTotals,\n    loading,\n  };\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { VNode } from 'preact';\nimport {\n  HTMLAttributes,\n  useCallback,\n  useEffect,\n  useState,\n  Fragment,\n} from 'preact/compat';\nimport { Container, Slot, SlotProps } from '@adobe-commerce/elsie/lib';\nimport { events } from '@adobe-commerce/event-bus';\nimport { CartModel, AppliedGiftCardProps } from '@/cart/data/models';\nimport { getPersistedCartData } from '@/cart/lib/persisted-data';\nimport { useEstimatedTotals } from '@/cart/hooks';\nimport { state } from '@/cart/lib/state';\nimport { Button, Price, Icon } from '@adobe-commerce/elsie/components';\nimport { useText, Text } from '@adobe-commerce/elsie/i18n';\nimport {\n  OrderSummary as OrderSummaryComponent,\n  OrderSummaryLineItem,\n} from '@/cart/components';\nimport { publishInitiateCheckoutEvent } from '@/cart/lib/acdl';\nimport { Coupon, GiftCard } from '@adobe-commerce/elsie/icons';\n\ninterface CheckoutRouteContext {\n  cartId: string;\n}\n\nexport interface OrderSummaryProps extends HTMLAttributes<HTMLDivElement> {\n  routeCheckout?: (context: CheckoutRouteContext) => string;\n  slots?: {\n    EstimateShipping?: SlotProps;\n    Coupons?: SlotProps;\n    GiftCards?: SlotProps;\n  };\n  enableCoupons?: boolean;\n  enableGiftCards?: boolean;\n  errors: boolean;\n  showTotalSaved?: boolean;\n  updateLineItems?: (\n    lineItems: Array<OrderSummaryLineItem>\n  ) => Array<OrderSummaryLineItem>;\n}\n\nexport const OrderSummary: Container<OrderSummaryProps, CartModel | null> = ({\n  children,\n  initialData = null,\n  routeCheckout,\n  slots,\n  errors,\n  showTotalSaved,\n  enableCoupons,\n  enableGiftCards,\n  updateLineItems = (lineItems) => lineItems,\n  ...props\n}) => {\n  const [data, setData] = useState<CartModel | null>(initialData);\n  const [hasQuantityErrors, setHasQuantityErrors] = useState(false);\n  const isVirtual = data?.isVirtual;\n\n  enableCoupons = enableCoupons ?? true;\n  enableGiftCards = enableGiftCards ?? true;\n\n  const {\n    handleEstimateTotals,\n    estimatedTotals,\n    setEstimatedTotals,\n    loading: handleEstimateLoading,\n  } = useEstimatedTotals();\n\n  const cartTaxesConfig = state.config?.shoppingCartDisplaySetting;\n  const isIncludingTax = cartTaxesConfig?.subtotal === 'INCLUDING_TAX';\n  const isIncludingAndExcludingTax =\n    cartTaxesConfig?.subtotal === 'INCLUDING_EXCLUDING_TAX';\n  const isZeroTax = cartTaxesConfig?.zeroTax;\n  const calculateTotalGiftCardAmount = () => {\n    return (\n      data?.appliedGiftCards.reduce((acc: number, current: any) => {\n        return acc + current.appliedBalance.value;\n      }, 0) ?? 0\n    );\n  };\n  const appliedGiftCardsPriceConfig = (giftCard: AppliedGiftCardProps) => {\n    if (!giftCard?.code) return null;\n\n    return (\n      <Fragment key={giftCard.code}>\n        <span className=\"cart-order-summary__coupon__code\">\n          <Icon source={GiftCard} size=\"16\" />\n          <span>{giftCard?.code}</span>\n        </span>\n        <span className=\"cart-order-summary__caption\">\n          <Text id=\"Cart.PriceSummary.giftCard.appliedGiftCards.remainingBalance\" />\n          <Price\n            className=\"cart-order-summary__caption\"\n            weight=\"normal\"\n            size=\"small\"\n            amount={giftCard.giftCardBalance.value}\n            currency={giftCard.giftCardBalance.currency}\n          />\n        </span>\n      </Fragment>\n    );\n  };\n  const cartGiftWrappingTax = state.config?.cartGiftWrapping;\n  const cartPrintedCardTax = state.config?.cartPrintedCard;\n  const totalGiftOptions = data?.totalGiftOptions;\n\n  useEffect(() => {\n    const dataEvent = events.on(\n      'cart/data',\n      (payload) => {\n        setData(payload as CartModel);\n\n        const shippingAddress = payload?.addresses?.shipping;\n        const isVirtual = payload?.isVirtual;\n\n        if (shippingAddress || isVirtual) {\n          setEstimatedTotals(null);\n        }\n\n        if (estimatedTotals == null) {\n          setEstimatedTotals({\n            estimatedTaxTotal: {\n              amount: payload?.totalTax?.value,\n              currency: payload?.totalTax?.currency,\n            },\n          });\n        }\n      },\n      { eager: true }\n    );\n\n    return () => {\n      dataEvent?.off();\n    };\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    setHasQuantityErrors(errors);\n  }, [errors]);\n\n  useEffect(() => {\n    const shippingEvent = events.on('shipping/estimate', (payload) => {\n      const formValues = {\n        shippingCountry: payload?.address?.countryCode,\n        shippingState: payload?.address?.region,\n        shippingStateId: payload?.address?.regionId,\n        shippingZip: payload?.address?.postCode,\n      };\n\n      const shippingMethods = {\n        carrier_code: payload?.shippingMethod?.carrierCode || '',\n        method_code: payload?.shippingMethod?.methodCode || '',\n      };\n\n      handleEstimateTotals(formValues, shippingMethods);\n    });\n\n    return () => {\n      shippingEvent?.off();\n    };\n  }, [handleEstimateTotals]);\n\n  const translations = useText({\n    checkout: 'Cart.PriceSummary.checkout',\n    free: 'Cart.PriceSummary.total.free',\n    orderSummary: 'Cart.PriceSummary.orderSummary',\n    taxToBeDetermined: 'Cart.PriceSummary.taxToBeDetermined',\n  });\n\n  const checkoutLinkDisabled = data?.hasOutOfStockItems || hasQuantityErrors;\n\n  const handleInitiateCheckout = useCallback(() => {\n    if (!checkoutLinkDisabled && data) {\n      publishInitiateCheckoutEvent(data, state.locale);\n    }\n  }, [checkoutLinkDisabled, data]);\n\n  const shipping =\n    !isVirtual && slots?.EstimateShipping ? (\n      <Slot\n        name=\"EstimateShipping\"\n        slot={slots.EstimateShipping}\n        key=\"estimateShippingId\"\n      />\n    ) : undefined;\n\n  if (!Object.keys(data ?? {}).length || data?.totalQuantity === 0) {\n    return null;\n  }\n\n  const coupons =\n    enableCoupons && slots?.Coupons ? (\n      <Slot name=\"Coupons\" slot={slots.Coupons} key=\"couponsId\" />\n    ) : undefined;\n\n  const giftCards =\n    enableGiftCards && slots?.GiftCards ? (\n      <Slot name=\"GiftCards\" slot={slots.GiftCards} key=\"giftCardId\" />\n    ) : undefined;\n\n  return (\n    <OrderSummaryComponent\n      {...props}\n      data-testid=\"cart-order-summary\"\n      heading={<div>{translations.orderSummary}</div>}\n      shipping={shipping}\n      coupons={coupons}\n      giftCards={giftCards}\n      loading={handleEstimateLoading}\n      updateLineItems={updateLineItems}\n      appliedGiftCards={\n        !data?.appliedGiftCards?.length\n          ? undefined\n          : {\n              label: (\n                <Text\n                  id=\"Cart.PriceSummary.giftCard.appliedGiftCards.label\"\n                  plural={data?.appliedGiftCards?.length}\n                  fields={{\n                    count: data?.appliedGiftCards?.length,\n                  }}\n                />\n              ),\n              price: (\n                <Price\n                  className=\"cart-order-summary__price\"\n                  amount={-calculateTotalGiftCardAmount()}\n                  currency={\n                    data?.appliedGiftCards?.[0]?.appliedBalance.currency\n                  }\n                />\n              ),\n              content: data?.appliedGiftCards\n                ?.map(appliedGiftCardsPriceConfig)\n                .filter(Boolean) as VNode[],\n            }\n      }\n      printedCard={{\n        renderContent: !!totalGiftOptions?.printedCard?.value,\n        taxIncluded: cartPrintedCardTax === 'INCLUDING_TAX',\n        taxInclAndExcl: cartPrintedCardTax === 'INCLUDING_EXCLUDING_TAX',\n        priceExclTax: (\n          <Price\n            data-testid=\"printed-card\"\n            amount={totalGiftOptions?.printedCard?.value}\n            currency={totalGiftOptions?.printedCard?.currency}\n          />\n        ),\n        priceInclTax: (\n          <Price\n            amount={totalGiftOptions?.printedCardInclTax?.value}\n            currency={totalGiftOptions?.printedCardInclTax?.currency}\n          />\n        ),\n      }}\n      itemsGiftWrapping={{\n        renderContent: !!totalGiftOptions?.giftWrappingForItems?.value,\n        taxIncluded: cartGiftWrappingTax === 'INCLUDING_TAX',\n        taxInclAndExcl: cartGiftWrappingTax === 'INCLUDING_EXCLUDING_TAX',\n        priceExclTax: (\n          <Price\n            amount={totalGiftOptions?.giftWrappingForItems?.value}\n            currency={totalGiftOptions?.giftWrappingForItems?.currency}\n          />\n        ),\n        priceInclTax: (\n          <Price\n            amount={totalGiftOptions?.giftWrappingForItemsInclTax?.value}\n            currency={totalGiftOptions?.giftWrappingForItemsInclTax?.currency}\n          />\n        ),\n      }}\n      orderGiftWrapping={{\n        renderContent: !!totalGiftOptions?.giftWrappingForOrder?.value,\n        taxIncluded: cartGiftWrappingTax === 'INCLUDING_TAX',\n        taxInclAndExcl: cartGiftWrappingTax === 'INCLUDING_EXCLUDING_TAX',\n        priceExclTax: (\n          <Price\n            amount={totalGiftOptions?.giftWrappingForOrder?.value}\n            currency={totalGiftOptions?.giftWrappingForOrder?.currency}\n          />\n        ),\n        priceInclTax: (\n          <Price\n            amount={totalGiftOptions?.giftWrappingForOrderInclTax?.value}\n            currency={totalGiftOptions?.giftWrappingForOrderInclTax?.currency}\n          />\n        ),\n      }}\n      subTotal={{\n        taxIncluded: isIncludingTax && !isZeroTax,\n        taxExcluded: isIncludingAndExcludingTax,\n        zeroTaxSubtotal: isZeroTax,\n        priceExcludingTax: estimatedTotals?.estimatedSubTotal?.excludingTax ? (\n          <Price\n            data-testid=\"subtotal\"\n            {...estimatedTotals?.estimatedSubTotal?.excludingTax}\n          />\n        ) : (\n          <Price\n            data-testid=\"subtotal\"\n            amount={data?.subtotal?.excludingTax?.value}\n            currency={data?.subtotal?.excludingTax?.currency}\n          />\n        ),\n        price:\n          (!isZeroTax && isIncludingTax) ||\n          (!isZeroTax && isIncludingAndExcludingTax) ? (\n            estimatedTotals?.estimatedSubTotal?.includingTax ? (\n              <Price\n                data-testid=\"subtotal\"\n                {...estimatedTotals?.estimatedSubTotal?.includingTax}\n              />\n            ) : (\n              <Price\n                data-testid=\"subtotal\"\n                amount={data?.subtotal.includingTax?.value}\n                currency={data?.subtotal.includingTax?.currency}\n              />\n            )\n          ) : (\n            <Price\n              data-testid=\"subtotal\"\n              amount={data?.subtotal?.excludingTax?.value}\n              currency={data?.subtotal?.excludingTax?.currency}\n            />\n          ),\n      }}\n      discounts={data?.appliedDiscounts?.map((discount) => {\n        return {\n          label: discount.label,\n          price: (\n            <Price\n              data-testid=\"summary-discount-total\"\n              amount={-discount.amount.value}\n              currency={discount.amount.currency}\n              sale={true}\n            />\n          ),\n          coupon: discount?.coupon ? (\n            <span>\n              <Icon source={Coupon} size=\"16\" />\n              {discount?.coupon?.code}\n            </span>\n          ) : undefined,\n        };\n      })}\n      taxTotal={\n        isVirtual ||\n        (estimatedTotals && estimatedTotals.estimatedTaxTotal == null)\n          ? {\n              price: (\n                <span data-testid=\"tax-total-tbd\">\n                  {translations.taxToBeDetermined}\n                </span>\n              ),\n            }\n          : {\n              price: estimatedTotals?.estimatedTaxTotal ? (\n                <Price\n                  data-testid=\"tax-total-estimated\"\n                  {...estimatedTotals?.estimatedTaxTotal}\n                />\n              ) : (\n                <Price\n                  data-testid=\"tax-total-actual\"\n                  amount={data?.totalTax?.value}\n                  currency={data?.totalTax?.currency}\n                />\n              ),\n              estimated:\n                (!estimatedTotals || !estimatedTotals.estimatedTaxTotal) &&\n                !data?.addresses?.shipping,\n            }\n      }\n      taxesApplied={\n        isVirtual\n          ? undefined\n          : cartTaxesConfig?.fullSummary\n          ? (\n              estimatedTotals?.estimatedAppliedTaxes?.taxes ||\n              data?.appliedTaxes\n            )?.map((tax: any) => ({\n              label: tax.label,\n              price: (\n                <Price\n                  data-testid=\"applied-taxes\"\n                  amount={tax.amount.value}\n                  currency={tax.amount.currency}\n                />\n              ),\n            }))\n          : undefined\n      }\n      total={{\n        price: estimatedTotals?.estimatedGrandTotalPrice ? (\n          estimatedTotals?.estimatedGrandTotalPrice?.includingTax?.amount ===\n          0 ? (\n            <span data-testid=\"total-including-tax\">{translations.free}</span>\n          ) : (\n            <Price\n              data-testid=\"total-including-tax-estimated\"\n              {...estimatedTotals?.estimatedGrandTotalPrice?.includingTax}\n            />\n          )\n        ) : data?.total?.includingTax.value === 0 ? (\n          <span data-testid=\"total-including-tax\">{translations.free}</span>\n        ) : (\n          <Price\n            data-testid=\"total-including-tax-actual\"\n            amount={data?.total?.includingTax.value}\n            currency={data?.total?.includingTax.currency}\n          />\n        ),\n        estimated:\n          (!estimatedTotals || !!estimatedTotals?.estimatedTaxTotal) &&\n          !data?.addresses?.shipping,\n        priceWithoutTax: cartTaxesConfig?.grandTotal ? (\n          estimatedTotals?.estimatedAppliedTaxes ? (\n            estimatedTotals?.estimatedGrandTotalPrice?.excludingTax?.amount ===\n            0 ? (\n              <span data-testid=\"total-excluding-tax\">{translations.free}</span>\n            ) : (\n              <Price\n                data-testid=\"total-excluding-tax\"\n                {...estimatedTotals?.estimatedGrandTotalPrice?.excludingTax}\n              />\n            )\n          ) : data?.total?.excludingTax.value === 0 ? (\n            <span data-testid=\"total-excluding-tax\">{translations.free}</span>\n          ) : (\n            <Price\n              data-testid=\"total-excluding-tax\"\n              amount={data?.total?.excludingTax.value}\n              currency={data?.total?.excludingTax.currency}\n            />\n          )\n        ) : undefined,\n      }}\n      primaryAction={\n        routeCheckout && (\n          <Button\n            data-testid=\"checkout-button\"\n            variant=\"primary\"\n            disabled={checkoutLinkDisabled}\n            aria-disabled={checkoutLinkDisabled}\n            href={\n              checkoutLinkDisabled\n                ? undefined\n                : routeCheckout({\n                    cartId: data!.id,\n                  })\n            }\n            onClick={handleInitiateCheckout}\n          >\n            {translations.checkout}\n          </Button>\n        )\n      }\n      totalSaved={\n        showTotalSaved ? (\n          <Price\n            amount={data?.discount?.value}\n            currency={data?.total?.includingTax.currency}\n          />\n        ) : undefined\n      }\n    />\n  );\n};\n\nOrderSummary.getInitialData = async function () {\n  return getPersistedCartData();\n};\n"],"names":["OrderSummary","className","children","variant","heading","loading","subTotal","shipping","discounts","taxTotal","taxesApplied","total","primaryAction","coupons","giftCards","totalSaved","appliedGiftCards","printedCard","itemsGiftWrapping","orderGiftWrapping","updateLineItems","lineItems","props","showTaxBreakdown","setShowTaxBreakdown","useState","translations","useText","appliedGiftCardsContent","jsx","OrderSummaryLine","subTotalContent","jsxs","discountsContent","Fragment","discount","VComponent","taxContent","Accordion","ChevronDown","ChevronUp","AccordionSection","tax","printedCardContent","itemsGiftWrappingContent","orderGiftWrappingContent","classes","updatedLineItems","currentLine","nextLine","ProgressSpinner","Divider","line","innerLine","useEstimatedTotals","setLoading","estimatedTotals","setEstimatedTotals","formValues","shippingMethods","shippingCountry","shippingState","shippingStateId","shippingZip","inputData","getEstimatedTotals","data","_a","_b","_d","_c","_f","_e","_h","_g","_j","_i","_l","_k","_n","_m","_o","_p","_q","_r","_s","_t","item","initialData","routeCheckout","slots","errors","showTotalSaved","enableCoupons","enableGiftCards","setData","hasQuantityErrors","setHasQuantityErrors","isVirtual","handleEstimateTotals","handleEstimateLoading","cartTaxesConfig","state","isIncludingTax","isIncludingAndExcludingTax","isZeroTax","calculateTotalGiftCardAmount","acc","current","appliedGiftCardsPriceConfig","giftCard","Icon","GiftCard","Text","Price","cartGiftWrappingTax","cartPrintedCardTax","totalGiftOptions","useEffect","dataEvent","events","payload","shippingAddress","shippingEvent","checkoutLinkDisabled","handleInitiateCheckout","useCallback","publishInitiateCheckoutEvent","Slot","OrderSummaryComponent","_u","_v","_w","_x","_y","_z","_B","_A","_D","_C","_E","_F","_G","_H","_J","_I","_L","_K","_M","Coupon","_N","_O","_P","_R","_Q","_T","_S","_U","_V","_W","_X","_Y","__","_Z","_$","_aa","_ba","_ca","Button","_da","_ea","getPersistedCartData"],"mappings":"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"}