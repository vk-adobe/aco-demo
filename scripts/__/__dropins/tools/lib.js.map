{"version":3,"file":"lib.js","sources":["/@dropins/tools/src/lib/form-values.ts","/@dropins/tools/src/lib/deepmerge.ts","/@dropins/tools/src/lib/i18n.ts","/@dropins/tools/src/lib/slot.tsx","/@dropins/tools/src/lib/get-cookie.ts"],"sourcesContent":["/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nexport const getFormValues = (form: HTMLFormElement) => {\n  const formData: any = new FormData(form);\n  const result = Object.fromEntries(formData);\n  return result;\n};\n\nexport const getFormErrors = (form: HTMLFormElement) => {\n  const formData: any = new FormData(form);\n\n  const data = Object.fromEntries(formData);\n\n  const result = Object.entries(data).reduce((result, [key]) => {\n    // @ts-ignore\n    const field = form.elements[key];\n\n    return field?.validationMessage\n      ? { ...result, [key]: field.validationMessage }\n      : { ...result };\n  }, {});\n\n  return result;\n};\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport deepmerge from 'deepmerge';\n\nexport { default as deepmerge } from 'deepmerge';\n\nconst mergeOptions = {\n  arrayMerge: (target: any, source: any, options: any) => {\n    const destination = target.slice();\n\n    source.forEach((item: any, index: number) => {\n      if (typeof destination[index] === 'undefined') {\n        destination[index] = options.cloneUnlessOtherwiseSpecified(\n          item,\n          options\n        );\n      } else if (options.isMergeableObject(item)) {\n        destination[index] = deepmerge(target[index], item, options);\n      } else if (target.indexOf(item) === -1) {\n        destination.push(item);\n      }\n    });\n    return destination;\n  },\n};\n\nexport function merge<T>(\n  prev: T,\n  next?: { [key: string]: any }\n) {\n  if (!next) return prev;\n\n  return deepmerge<T, { [key: string]: any }>(\n    prev,\n    next,\n    mergeOptions\n  );\n}\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\n/**\n * Convert locale from Magento standard to react-intl BCP 47 language tag\n *\n * @param {string} locale - A locale (e.g. `fr_FR`).\n * @returns {string} A BCP 47 language tag (e.g. `fr-FR`).\n */\nexport const toLanguageTag = (locale: string) => {\n  return locale.replace('_', '-');\n};\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { cloneElement, ComponentChildren, RefObject, VNode, createElement } from 'preact';\nimport {\n  StateUpdater,\n  useContext,\n  useState,\n  useRef,\n  useEffect,\n  useMemo,\n  useCallback,\n} from 'preact/hooks';\nimport { IntlContext, Lang } from '@adobe-commerce/elsie/i18n';\nimport { HTMLAttributes } from 'preact/compat';\nimport { SlotQueueContext } from './render';\n\nimport '@adobe-commerce/elsie/components/UIProvider/debugger.css';\n\ntype MutateElement = (elem: HTMLElement) => void;\n\n\ninterface State {\n  get: (key: string) => void;\n  set: (key: string, value: any) => void;\n}\n\ninterface SlotElement {\n  appendChild: MutateElement;\n  prependChild: MutateElement;\n  appendSibling: MutateElement;\n  prependSibling: MutateElement;\n}\n\ninterface PrivateContext<T> {\n  _setProps: (s: StateUpdater<{}>) => void;\n  _registerMethod: (\n    cb: (next: T & DefaultSlotContext<T>, state: State) => void\n  ) => void;\n  // eslint-disable-next-line no-undef\n  _htmlElementToVNode: (element: HTMLElement, tag: keyof HTMLElementTagNameMap) => VNode;\n}\n\ninterface DefaultSlotContext<T> extends PrivateContext<T> {\n  dictionary: Lang;\n  getSlotElement: (key: string) => SlotElement;\n  replaceWith: MutateElement;\n  appendChild: MutateElement;\n  prependChild: MutateElement;\n  appendSibling: MutateElement;\n  prependSibling: MutateElement;\n  onRender: (cb: (next: T & DefaultSlotContext<T>) => void) => void;\n  onChange: (cb: (next: T & DefaultSlotContext<T>) => void) => void;\n}\n\ntype Context<T> = T & ThisType<DefaultSlotContext<T>>; // NOSONAR\n\nexport type SlotProps<T = any> = (\n  ctx: T & DefaultSlotContext<T>,\n  element: HTMLDivElement | null\n) => Promise<void> | void;\n\nexport type SlotMethod<P = any> = (\n  callback: (next: unknown, state: State) => P\n) => void;\n\n// Slot Hook\nexport function useSlot<K, V extends HTMLElement>(\n  name: string,\n  // @ts-ignore\n  context: Context<K> = {},\n  callback?: SlotProps<K>,\n  children?: ComponentChildren,\n  render?: Function,\n  // eslint-disable-next-line no-undef\n  contentTag: keyof HTMLElementTagNameMap = 'div'\n): [RefObject<V>, Record<string, any>] {\n  const slotsQueue = useContext(SlotQueueContext);\n\n  // HTML Element\n  const elementRef = useRef<V>(null);\n\n  const status = useRef<'pending' | 'ready' | 'loading'>('pending');\n\n  // Methods\n  const methodsRef = useRef<any>([]);\n\n  // Children VNodes\n  const [props, _setProps] = useState<Record<string, any>>({\n    children: [children],\n  });\n\n  // Attributes\n  const [_state, setState] = useState<any>({});\n\n  const state = useMemo(\n    () => ({\n      get: (key: string) => _state[key],\n      set: (key: string, value: any) => {\n        setState({ ...state, [key]: value });\n      },\n    }),\n    [_state]\n  );\n\n  /** Internationalization */\n  // @ts-ignore\n  const { intl }: any = useContext(IntlContext);\n\n  // @ts-ignore\n  context.dictionary = intl.dictionary;\n\n  /** Privates */\n  // @ts-ignore\n  context._setProps = (next: State<any>) => {\n    _setProps((prev) => {\n      // next props\n      const _next = typeof next === 'function' ? next(prev) : next;\n\n      // On render method...\n      if (render) {\n        const renderNode = cloneElement(render(prev), { key: 'render' });\n\n        // find index of existing render node\n        const index = prev.children.findIndex((n: any) => n?.key === 'render');\n\n        // replace existing render node\n        prev.children[index] = renderNode;\n      }\n\n      return _next;\n    });\n  };\n\n  const _registerMethod = useCallback((cb: Function) => {\n    if (typeof cb === 'function') {\n      methodsRef.current.push(cb);\n    } else {\n      console.warn('Skipped: Invalid _registerMethod', cb);\n    }\n  }, []);\n\n  // @ts-ignore\n  context._registerMethod = _registerMethod;\n\n  const _htmlElementToVNode = useCallback((elem: HTMLElement) => {\n    return createElement(\n      contentTag,\n      {\n        'data-slot-html-element': elem.tagName.toLowerCase(),\n        ref: (refElem: HTMLElement | null): void => {\n          refElem?.appendChild(elem);\n        }\n      },\n      null\n    );\n  }, [contentTag]);\n\n  // @ts-ignore\n  context._htmlElementToVNode = _htmlElementToVNode;\n\n  /** Prebuilt Methods */\n  // @ts-ignore\n  context.getSlotElement = useCallback(\n    (key: string) => {\n      const element = elementRef.current?.querySelector(\n        `[data-slot-key=\"${key}\"]`\n      );\n\n      log(\n        `ðŸŸ¦ \"${name}\" Slot getSlotElement: ${key}`,\n        elementRef.current?.cloneNode(true),\n        element?.cloneNode(true)\n      );\n\n      if (!element) return;\n\n      return {\n        appendChild: (elem: HTMLElement) => {\n          element.appendChild(elem);\n        },\n\n        prependChild: (elem: HTMLElement) => {\n          element.insertBefore(elem, element.firstChild);\n        },\n\n        appendSibling: (elem: HTMLElement) => {\n          const parent = element.parentNode;\n          parent?.insertBefore(elem, element.nextSibling);\n        },\n\n        prependSibling: (elem: HTMLElement) => {\n          const parent = element.parentNode;\n          parent?.insertBefore(elem, element);\n        },\n      };\n    },\n    [name]\n  );\n\n  // @ts-ignore\n  context.onRender = useCallback((cb: Function) => {\n    methodsRef.current.push(cb);\n  }, []);\n\n  /**\n   * @deprecated Use `onRender` instead.\n   */\n  // @ts-ignore\n  context.onChange = context.onRender;\n\n  // @ts-ignore\n  context.replaceWith = useCallback(\n    (elem: HTMLElement) => {\n      // @ts-ignore\n      _registerMethod((next) => {\n        // @ts-ignore\n        const children = _htmlElementToVNode(elem);\n\n        next._setProps({ children: [children] });\n      });\n    },\n    [_htmlElementToVNode, _registerMethod]\n  );\n\n  // @ts-ignore\n  context.appendChild = useCallback(\n    (elem: HTMLElement) => {\n      // @ts-ignore\n      _registerMethod((next) => {\n        // @ts-ignore\n        const vnode = _htmlElementToVNode(elem);\n\n        next._setProps((prev: any) => {\n          return {\n            ...prev,\n            children: [...prev.children, vnode],\n          };\n        });\n      });\n    },\n    [_htmlElementToVNode, _registerMethod]\n  );\n\n  // @ts-ignore\n  context.prependChild = useCallback(\n    (elem: HTMLElement) => {\n      // @ts-ignore\n      _registerMethod((next) => {\n        // @ts-ignore\n        const vnode = _htmlElementToVNode(elem);\n\n        next._setProps((prev: any) => {\n          return {\n            ...prev,\n            children: [vnode, ...prev.children],\n          };\n        });\n      });\n    },\n    [_htmlElementToVNode, _registerMethod]\n  );\n\n  // @ts-ignore\n  context.appendSibling = useCallback(\n    (elem: HTMLElement) => {\n      // @ts-ignore\n      _registerMethod(() => {\n        const parent = elementRef.current?.parentNode;\n\n        parent?.insertBefore(elem, elementRef.current?.nextSibling ?? null);\n      });\n    },\n    [_registerMethod]\n  );\n\n  // @ts-ignore\n  context.prependSibling = useCallback(\n    (elem: HTMLElement) => {\n      // @ts-ignore\n      _registerMethod(() => {\n        const parent = elementRef.current?.parentNode;\n\n        parent?.insertBefore(elem, elementRef.current);\n      });\n    },\n    [_registerMethod]\n  );\n\n  const handleLifeCycleRender = useCallback(async () => {\n    if (status.current === 'loading') return;\n\n    status.current = 'loading';\n\n    log(`ðŸŸ¨ \"${name}\" Slot Rendered`);\n\n    // Reset\n    const renderNode = render\n      ? cloneElement(render(props), { key: 'render' })\n      : null;\n    _setProps({ children: [renderNode ?? children] });\n\n    // Run all registered methods\n    methodsRef.current.forEach((method: any) => {\n      method(context, state);\n    });\n\n    status.current = 'ready';\n  }, [children, context, name, props, render, state]);\n\n  // Initialization\n  const handleLifeCycleInit = useCallback(async () => {\n    if (!callback) return;\n\n    try {\n      status.current = 'loading';\n\n      log(`ðŸŸ© \"${name}\" Slot Initialized`);\n      await callback(context as K & DefaultSlotContext<K>, elementRef.current as HTMLDivElement | null);\n    } catch (error) {\n      console.error(`Error in \"${callback.name}\" Slot callback`, error);\n    } finally {\n      status.current = 'ready';\n\n      // first render\n      await handleLifeCycleRender();\n    }\n  }, [callback, context, handleLifeCycleRender, name]);\n\n  // Initialization\n  useEffect(() => {\n    handleLifeCycleInit().finally(() => {\n      if (slotsQueue) {\n        slotsQueue.value.delete(name);\n        slotsQueue.value = new Set(slotsQueue.value);\n      }\n    });\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Update\n  useEffect(() => {\n    handleLifeCycleRender();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [JSON.stringify(context), JSON.stringify(_state)]);\n\n  return [elementRef, props];\n}\n\n// Slot Component\ninterface SlotPropsComponent<T>\n  extends Omit<HTMLAttributes<HTMLElement>, 'slot'> {\n  name: string;\n  slot?: SlotProps<T>;\n  context?: Context<T>;\n  render?: (props: Record<string, any>) => VNode | VNode[];\n  // eslint-disable-next-line no-undef\n  slotTag?: keyof HTMLElementTagNameMap; // The tag for the slot wrapper itself\n  // eslint-disable-next-line no-undef\n  contentTag?: keyof HTMLElementTagNameMap; // The tag for dynamically inserted content\n  children?: ComponentChildren;\n}\n\nexport function Slot<T>({\n  name,\n  context,\n  slot,\n  children,\n  render,\n  slotTag = 'div',\n  contentTag = 'div',\n  ...props\n}: Readonly<SlotPropsComponent<T>>): VNode<{\n  ref: RefObject<HTMLElement>;\n  'data-slot': string;\n  [key: string]: any;\n}> {\n  const slotsQueue = useContext(SlotQueueContext);\n\n  const [elementRef, slotProps] = useSlot<T, HTMLElement>(\n    name,\n    context,\n    slot,\n    children,\n    render,\n    contentTag\n  );\n\n  useMemo(() => {\n    if (!name) {\n      return console.warn('Slot \"name\" is required');\n    }\n\n    // add slot to queue\n    if (slotsQueue) {\n      slotsQueue.value.add(name);\n      slotsQueue.value = new Set(slotsQueue.value);\n    }\n  }, [name, slotsQueue]);\n\n  return createElement(\n    slotTag,\n    {\n      ...props,\n      ref: elementRef,\n      'data-slot': name,\n    },\n    slotProps.children\n  );\n}\n\n// Debugger\n\n// @ts-ignore\nwindow.DROPINS = window.DROPINS || {};\n\n// @ts-ignore\nwindow.DROPINS.showSlots = async (state) => {\n  // cache state in session storage\n  window.sessionStorage.setItem(\n    'dropin-debugger--show-slots',\n    state.toString()\n  );\n\n  document.body.classList.toggle('dropin-debugger--show-slots', state);\n};\n\nlet log: (...attrs: any) => void = () => {};\n\n// @ts-ignore\nwindow.DROPINS.logSlots = async (state) => {\n  // cache state in session storage\n  window.sessionStorage.setItem('dropin-debugger--log-slots', state.toString());\n\n  log = state ? (...attrs) => console.log(...attrs) : () => {};\n};\n\n/** Persistent Settings */\n\n// @ts-ignore\nwindow.DROPINS.showSlots(\n  window.sessionStorage.getItem('dropin-debugger--show-slots') === 'true'\n);\n\n// @ts-ignore\nwindow.DROPINS.logSlots(\n  window.sessionStorage.getItem('dropin-debugger--log-slots') === 'true'\n);\n","/**\n * Get cookie\n * @param {string} cookieName - The name of the cookie to get\n * @returns {string} - The value of the cookie\n */\nexport function getCookie(cookieName: string): string | undefined {\n  const cookies = document.cookie.split(';');\n  let foundValue;\n\n  cookies.forEach((cookie) => {\n    const [name, value] = cookie.trim().split('=');\n    if (name === cookieName) {\n      foundValue = decodeURIComponent(value);\n    }\n  });\n\n  return foundValue;\n}\n"],"names":["getFormValues","form","formData","getFormErrors","data","result","key","field","mergeOptions","target","source","options","destination","item","index","deepmerge","merge","prev","next","toLanguageTag","locale","useSlot","name","context","callback","children","render","contentTag","slotsQueue","useContext","SlotQueueContext","elementRef","useRef","status","methodsRef","props","_setProps","useState","_state","setState","state","useMemo","value","intl","IntlContext","_next","renderNode","cloneElement","n","_registerMethod","useCallback","cb","_htmlElementToVNode","elem","createElement","refElem","element","_a","log","_b","parent","vnode","handleLifeCycleRender","method","handleLifeCycleInit","error","useEffect","Slot","slot","slotTag","slotProps","attrs","getCookie","cookieName","cookies","foundValue","cookie"],"mappings":"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"}