{"version":3,"file":"ProductAttributes.js","sources":["/@dropins/storefront-pdp/src/containers/ProductAttributes/ProductAttributes.tsx"],"sourcesContent":["/**\n * ADOBE CONFIDENTIAL\n * __________________\n * Copyright 2024 Adobe\n * All Rights Reserved.\n * __________________\n * NOTICE: All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n */\n\nimport { HTMLAttributes, useEffect, useState, useMemo } from 'preact/compat';\nimport { classes, Container, Slot, SlotProps } from '@adobe-commerce/elsie/lib';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { events } from '@adobe-commerce/event-bus';\nimport { ProductModel } from '@/pdp/data/models';\nimport { isDateValid, toDateString } from '@/pdp/lib/date';\nimport { config, getFetchedProductData } from '@/pdp/api';\n\ntype DefaultSlotContext = {\n  data: ProductModel | null;\n};\n\nexport interface ProductAttributesProps extends HTMLAttributes<HTMLDivElement> {\n  slots?: {\n    Attributes?: SlotProps<DefaultSlotContext>;\n  };\n}\n\nexport const ProductAttributes: Container<\n  ProductAttributesProps,\n  ProductModel | null\n> = ({ initialData = null, children, slots, ...props }) => {\n  const DetailsLabel = useText('PDP.Product.Details.label').label;\n  const { defaultLocale = 'en-US' } = config.getConfig();\n\n  const [locale, setLocale] = useState<string>(defaultLocale);\n\n  const [data, setData] = useState<ProductModel | null>(initialData);\n\n  const defaultSlotContext: DefaultSlotContext = useMemo(\n    () => ({ data }),\n    [data]\n  );\n\n  useEffect(() => {\n    const dataEvent = events.on('pdp/data', setData);\n    const localeEvent = events.on('locale', setLocale);\n\n    return () => {\n      dataEvent?.off();\n      localeEvent?.off();\n    };\n  }, []);\n\n  if (!data) return null;\n\n  return (\n    <div {...props} className={classes(['pdp-attributes', props.className])}>\n      {DetailsLabel}\n      {slots?.Attributes ? (\n        <Slot\n          name=\"Attributes\"\n          slot={slots?.Attributes}\n          context={{ ...defaultSlotContext }}\n        />\n      ) : (\n        <ul>\n          {data?.attributes?.map(({ label, value }, key) => {\n            const __html = isDateValid(value)\n              ? toDateString(value, locale)\n              : value.toString();\n\n            return (\n              <li key={key}>\n                {/* eslint-disable-next-line react/no-danger */}\n                {label}: <span dangerouslySetInnerHTML={{ __html }} />\n              </li>\n            );\n          })}\n        </ul>\n      )}\n    </div>\n  );\n};\n\nProductAttributes.getInitialData = getFetchedProductData;\n"],"names":["ProductAttributes","initialData","children","slots","props","DetailsLabel","useText","defaultLocale","config","locale","setLocale","useState","data","setData","defaultSlotContext","useMemo","useEffect","dataEvent","events","localeEvent","jsxs","classes","jsx","Slot","_a","label","value","key","__html","isDateValid","toDateString","getFetchedProductData"],"mappings":"6hBAkCa,MAAAA,EAGT,CAAC,CAAE,YAAAC,EAAc,KAAM,SAAAC,EAAU,MAAAC,EAAO,GAAGC,KAAY,OACnD,MAAAC,EAAeC,EAAQ,2BAA2B,EAAE,MACpD,CAAE,cAAAC,EAAgB,SAAYC,EAAO,UAAU,EAE/C,CAACC,EAAQC,CAAS,EAAIC,EAAiBJ,CAAa,EAEpD,CAACK,EAAMC,CAAO,EAAIF,EAA8BV,CAAW,EAE3Da,EAAyCC,EAC7C,KAAO,CAAE,KAAAH,CAAK,GACd,CAACA,CAAI,CACP,EAYI,OAVJI,EAAU,IAAM,CACd,MAAMC,EAAYC,EAAO,GAAG,WAAYL,CAAO,EACzCM,EAAcD,EAAO,GAAG,SAAUR,CAAS,EAEjD,MAAO,IAAM,CACXO,GAAA,MAAAA,EAAW,MACXE,GAAA,MAAAA,EAAa,KACf,CACF,EAAG,EAAE,EAEAP,EAGHQ,EAAC,MAAK,CAAA,GAAGhB,EAAO,UAAWiB,EAAQ,CAAC,iBAAkBjB,EAAM,SAAS,CAAC,EACnE,SAAA,CAAAC,EACAF,GAAA,MAAAA,EAAO,WACNmB,EAACC,EAAA,CACC,KAAK,aACL,KAAMpB,GAAA,YAAAA,EAAO,WACb,QAAS,CAAE,GAAGW,CAAmB,CAAA,CACnC,EAECQ,EAAA,KAAA,CACE,UAAME,EAAAZ,GAAA,YAAAA,EAAA,aAAA,YAAAY,EAAY,IAAI,CAAC,CAAE,MAAAC,EAAO,MAAAC,CAAM,EAAGC,IAAQ,CAC1C,MAAAC,EAASC,EAAYH,CAAK,EAC5BI,EAAaJ,EAAOjB,CAAM,EAC1BiB,EAAM,SAAS,EAEnB,SACG,KAEE,CAAA,SAAA,CAAAD,EAAM,KAAGH,EAAA,OAAA,CAAK,wBAAyB,CAAE,OAAAM,EAAU,CAAA,CAAA,CAAA,EAF7CD,CAGT,CAAA,EAGN,CAAA,CAAA,EAEJ,EA3BgB,IA6BpB,EAEA3B,EAAkB,eAAiB+B"}