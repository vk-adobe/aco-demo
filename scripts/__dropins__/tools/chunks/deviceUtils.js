/*! Copyright 2025 Adobe
All Rights Reserved. */
var me=Object.defineProperty;var be=(e,t,r)=>t in e?me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var re=(e,t,r)=>be(e,typeof t!="symbol"?t+"":t,r);import{g as we}from"./image-params-keymap.js";import{jsx as $}from"../preact-jsx-runtime.js";import{l as h,_ as pe,k as E,G as xe,B as ne}from"./icons/Add.js";import{signal as ie}from"../signals.js";const Oe=e=>e.reduce((r,n)=>{if(!n)return r;if(typeof n=="string"&&(r+=` ${n}`),Array.isArray(n)){const[f,_]=n;f&&_&&(r+=` ${f}`)}return r},"").trim(),Ee=(e,t)=>{let r;return function(...n){clearTimeout(r),r=setTimeout(()=>e.apply(this,n),t)}},se={medium:768,large:1024,xlarge:1366,xxlarge:1920},je=(e,t)=>{const[r,n]=e.split("?"),f=new URLSearchParams(n),_=we(),v=_&&Object.keys(_)||[];let c={},m={..._};return(v==null?void 0:v.length)>0&&t?c=Object.entries(t).reduce((p,[y,a])=>{const o=_[y];if(typeof o=="string")p[o]=a;else if(typeof o=="function"){const[x,w]=o(a);p[x]=w}return delete m[y],p},{}):c={auto:"webp",quality:80,crop:!1,fit:"cover",...t},Object.entries(m).forEach(([,p])=>{if(typeof p=="function"){const[y,a]=p(void 0);c[y]=a}}),Object.entries(c).forEach(([p,y])=>{y!=null&&f.set(p,String(y))}),`${r}?${f.toString()}`},Ve=(e,t)=>{if(!e||!(t!=null&&t.width))return;const r=n=>je(e,{...n});return Object.entries(se).map(([,n])=>{const f=t.width*n/se.xxlarge;return`${r({...t,width:f})} ${n}w`}).join(`,
`)};var Ae=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,_e=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,z=/[\s\n\\/='"\0<>]/,ve=/^xlink:?./,Se=/["&<]/;function q(e){if(Se.test(e+="")===!1)return e;for(var t=0,r=0,n="",f="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:f="&quot;";break;case 38:f="&amp;";break;case 60:f="&lt;";break;default:continue}r!==t&&(n+=e.slice(t,r)),n+=f,t=r+1}return r!==t&&(n+=e.slice(t,r)),n}var oe=function(e,t){return String(e).replace(/(\n+)/g,"$1"+(t||"	"))},ae=function(e,t,r){return String(e).length>40||String(e).indexOf(`
`)!==-1||String(e).indexOf("<")!==-1},le={},$e=/([A-Z])/g;function he(e){var t="";for(var r in e){var n=e[r];n!=null&&n!==""&&(t&&(t+=" "),t+=r[0]=="-"?r:le[r]||(le[r]=r.replace($e,"-$1").toLowerCase()),t=typeof n=="number"&&Ae.test(r)===!1?t+": "+n+"px;":t+": "+n+";")}return t||void 0}function I(e,t){return Array.isArray(t)?t.reduce(I,e):t!=null&&t!==!1&&e.push(t),e}function ue(){this.__d=!0}function ge(e,t){return{__v:e,context:t,props:e.props,setState:ue,forceUpdate:ue,__d:!0,__h:[]}}function K(e,t){var r=e.contextType,n=r&&t[r.__c];return r!=null?n?n.props.value:r.__:t}var Q=[];function F(e,t,r,n,f,_){if(e==null||typeof e=="boolean")return"";if(typeof e!="object")return typeof e=="function"?"":q(e);var v=r.pretty,c=v&&typeof v=="string"?v:"	";if(Array.isArray(e)){for(var m="",p=0;p<e.length;p++)v&&p>0&&(m+=`
`),m+=F(e[p],t,r,n,f,_);return m}if(e.constructor!==void 0)return"";var y,a=e.type,o=e.props,x=!1;if(typeof a=="function"){if(x=!0,!r.shallow||!n&&r.renderRootComponent!==!1){if(a===E){var w=[];return I(w,e.props.children),F(w,t,r,r.shallowHighOrder!==!1,f,_)}var g,i=e.__c=ge(e,t);h.__b&&h.__b(e);var M=h.__r;if(a.prototype&&typeof a.prototype.render=="function"){var C=K(a,t);(i=e.__c=new a(o,C)).__v=e,i._dirty=i.__d=!0,i.props=o,i.state==null&&(i.state={}),i._nextState==null&&i.__s==null&&(i._nextState=i.__s=i.state),i.context=C,a.getDerivedStateFromProps?i.state=Object.assign({},i.state,a.getDerivedStateFromProps(i.props,i.state)):i.componentWillMount&&(i.componentWillMount(),i.state=i._nextState!==i.state?i._nextState:i.__s!==i.state?i.__s:i.state),M&&M(e),g=i.render(i.props,i.state,i.context)}else for(var N=K(a,t),D=0;i.__d&&D++<25;)i.__d=!1,M&&M(e),g=a.call(e.__c,o,N);return i.getChildContext&&(t=Object.assign({},t,i.getChildContext())),h.diffed&&h.diffed(e),F(g,t,r,r.shallowHighOrder!==!1,f,_)}a=(y=a).displayName||y!==Function&&y.name||function(X){var J=(Function.prototype.toString.call(X).match(/^\s*function\s+([^( ]+)/)||"")[1];if(!J){for(var W=-1,Y=Q.length;Y--;)if(Q[Y]===X){W=Y;break}W<0&&(W=Q.push(X)-1),J="UnnamedComponent"+W}return J}(y)}var j,O,d="<"+a;if(o){var b=Object.keys(o);r&&r.sortAttributes===!0&&b.sort();for(var k=0;k<b.length;k++){var s=b[k],u=o[s];if(s!=="children"){if(!z.test(s)&&(r&&r.allAttributes||s!=="key"&&s!=="ref"&&s!=="__self"&&s!=="__source")){if(s==="defaultValue")s="value";else if(s==="defaultChecked")s="checked";else if(s==="defaultSelected")s="selected";else if(s==="className"){if(o.class!==void 0)continue;s="class"}else f&&ve.test(s)&&(s=s.toLowerCase().replace(/^xlink:?/,"xlink:"));if(s==="htmlFor"){if(o.for)continue;s="for"}s==="style"&&u&&typeof u=="object"&&(u=he(u)),s[0]==="a"&&s[1]==="r"&&typeof u=="boolean"&&(u=String(u));var l=r.attributeHook&&r.attributeHook(s,u,t,r,x);if(l||l==="")d+=l;else if(s==="dangerouslySetInnerHTML")O=u&&u.__html;else if(a==="textarea"&&s==="value")j=u;else if((u||u===0||u==="")&&typeof u!="function"){if(!(u!==!0&&u!==""||(u=s,r&&r.xml))){d=d+" "+s;continue}if(s==="value"){if(a==="select"){_=u;continue}a==="option"&&_==u&&o.selected===void 0&&(d+=" selected")}d=d+" "+s+'="'+q(u)+'"'}}}else j=u}}if(v){var A=d.replace(/\n\s*/," ");A===d||~A.indexOf(`
`)?v&&~d.indexOf(`
`)&&(d+=`
`):d=A}if(d+=">",z.test(a))throw new Error(a+" is not a valid HTML tag name in "+d);var P,ye=_e.test(a)||r.voidElements&&r.voidElements.test(a),S=[];if(O)v&&ae(O)&&(O=`
`+c+oe(O,c)),d+=O;else if(j!=null&&I(P=[],j).length){for(var U=v&&~d.indexOf(`
`),ee=!1,Z=0;Z<P.length;Z++){var B=P[Z];if(B!=null&&B!==!1){var L=F(B,t,r,!0,a==="svg"||a!=="foreignObject"&&f,_);if(v&&!U&&ae(L)&&(U=!0),L)if(v){var te=L.length>0&&L[0]!="<";ee&&te?S[S.length-1]+=L:S.push(L),ee=te}else S.push(L)}}if(v&&U)for(var G=S.length;G--;)S[G]=`
`+c+oe(S[G],c)}if(S.length||O)d+=S.join("");else if(r&&r.xml)return d.substring(0,d.length-1)+" />";return!ye||P||O?(v&&~d.indexOf(`
`)&&(d+=`
`),d=d+"</"+a+">"):d=d.replace(/>$/," />"),d}var Ce={shallow:!0};V.render=V;var ke=function(e,t){return V(e,t,Ce)},fe=[];function V(e,t,r){t=t||{};var n=h.__s;h.__s=!0;var f,_=pe(E,null);return _.__k=[e],f=r&&(r.pretty||r.voidElements||r.sortAttributes||r.shallow||r.allAttributes||r.xml||r.attributeHook)?F(e,t,r):T(e,t,!1,void 0,_),h.__c&&h.__c(e,fe),h.__s=n,fe.length=0,f}function R(e){return e==null||typeof e=="boolean"?null:typeof e=="string"||typeof e=="number"||typeof e=="bigint"?pe(null,null,e):e}function Ne(e,t){return e==="className"?"class":e==="htmlFor"?"for":e==="defaultValue"?"value":e==="defaultChecked"?"checked":e==="defaultSelected"?"selected":t&&ve.test(e)?e.toLowerCase().replace(/^xlink:?/,"xlink:"):e}function Le(e,t){return e==="style"&&t!=null&&typeof t=="object"?he(t):e[0]==="a"&&e[1]==="r"&&typeof t=="boolean"?String(t):t}var ce=Array.isArray,de=Object.assign;function T(e,t,r,n,f){if(e==null||e===!0||e===!1||e==="")return"";if(typeof e!="object")return typeof e=="function"?"":q(e);if(ce(e)){var _="";f.__k=e;for(var v=0;v<e.length;v++)_+=T(e[v],t,r,n,f),e[v]=R(e[v]);return _}if(e.constructor!==void 0)return"";e.__=f,h.__b&&h.__b(e);var c=e.type,m=e.props;if(typeof c=="function"){var p;if(c===E)p=m.children;else{p=c.prototype&&typeof c.prototype.render=="function"?function(b,k){var s=b.type,u=K(s,k),l=new s(b.props,u);b.__c=l,l.__v=b,l.__d=!0,l.props=b.props,l.state==null&&(l.state={}),l.__s==null&&(l.__s=l.state),l.context=u,s.getDerivedStateFromProps?l.state=de({},l.state,s.getDerivedStateFromProps(l.props,l.state)):l.componentWillMount&&(l.componentWillMount(),l.state=l.__s!==l.state?l.__s:l.state);var A=h.__r;return A&&A(b),l.render(l.props,l.state,l.context)}(e,t):function(b,k){var s,u=ge(b,k),l=K(b.type,k);b.__c=u;for(var A=h.__r,P=0;u.__d&&P++<25;)u.__d=!1,A&&A(b),s=b.type.call(u,b.props,l);return s}(e,t);var y=e.__c;y.getChildContext&&(t=de({},t,y.getChildContext()))}var a=T(p=p!=null&&p.type===E&&p.key==null?p.props.children:p,t,r,n,e);return h.diffed&&h.diffed(e),e.__=void 0,h.unmount&&h.unmount(e),a}var o,x,w="<";if(w+=c,m)for(var g in o=m.children,m){var i=m[g];if(!(g==="key"||g==="ref"||g==="__self"||g==="__source"||g==="children"||g==="className"&&"class"in m||g==="htmlFor"&&"for"in m||z.test(g))){if(i=Le(g=Ne(g,r),i),g==="dangerouslySetInnerHTML")x=i&&i.__html;else if(c==="textarea"&&g==="value")o=i;else if((i||i===0||i==="")&&typeof i!="function"){if(i===!0||i===""){i=g,w=w+" "+g;continue}if(g==="value"){if(c==="select"){n=i;continue}c!=="option"||n!=i||"selected"in m||(w+=" selected")}w=w+" "+g+'="'+q(i)+'"'}}}var M=w;if(w+=">",z.test(c))throw new Error(c+" is not a valid HTML tag name in "+w);var C="",N=!1;if(x)C+=x,N=!0;else if(typeof o=="string")C+=q(o),N=!0;else if(ce(o)){e.__k=o;for(var D=0;D<o.length;D++){var j=o[D];if(o[D]=R(j),j!=null&&j!==!1){var O=T(j,t,c==="svg"||c!=="foreignObject"&&r,n,e);O&&(C+=O,N=!0)}}}else if(o!=null&&o!==!1&&o!==!0){e.__k=[R(o)];var d=T(o,t,c==="svg"||c!=="foreignObject"&&r,n,e);d&&(C+=d,N=!0)}if(h.diffed&&h.diffed(e),e.__=void 0,h.unmount&&h.unmount(e),N)w+=C;else if(_e.test(c))return M+" />";return w+"</"+c+">"}V.shallowRender=ke;const Me=xe(null);class We{constructor(t){re(this,"_provider");this._provider=t}render(t,r){return async n=>{var a;if(!t)throw new Error("Component is not defined");if(!n)throw new Error("Root element is not defined");const f=await((a=t.getInitialData)==null?void 0:a.call(t,r))??{},_=ie({...r}),v=ie(new Set),c=this._provider,m=({next:o})=>$(Me.Provider,{value:v,children:$(H,{node:c,...c.props,children:$(t,{...o.value,initialData:f})})});n.innerHTML="";const p=document.createElement("div");n.classList.add("dropin-design"),ne($(m,{next:_}),p);const y={remove:()=>{ne(null,p)},setProps:o=>{const x=o(_.peek());_.value=x}};return new Promise(o=>{v.subscribe(x=>{if(x.size===0)return n.classList.add("dropin-design"),n.appendChild(p.firstChild??p),o(y)})})}}unmount(t){var r;if(!t)throw new Error("Root element is not defined");(r=t.firstChild)==null||r.remove()}async toString(t,r,n){var _;if(!t)throw new Error("Component is not defined");const f=await((_=t.getInitialData)==null?void 0:_.call(t,r))??{};return V($(H,{node:this._provider,...this._provider.props,children:$(t,{...r,initialData:f})}),{},{...n})}}function H({node:e,...t}){return e?Array.isArray(e)?$(E,{children:e.map((r,n)=>$(H,{node:r,className:t.className,...t},n))}):(t.className=Oe([e.props.className,t.className]),$(e.type,{ref:e.ref,...e.props,...t},e.key)):null}const ze=e=>typeof e=="number",Ke=()=>{const e=navigator.userAgent.toLowerCase(),t=/ipad|iphone|ipod/.test(e),r=e.includes("mac")&&"ontouchend"in document;return t||r};export{We as R,Me as S,H as V,Ke as a,Oe as c,Ee as d,Ve as g,ze as i};
//# sourceMappingURL=deviceUtils.js.map
