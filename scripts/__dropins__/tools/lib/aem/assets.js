/*! Copyright 2025 Adobe
All Rights Reserved. */
import{getConfigValue as b}from"./configs.js";import{p as l,I as u}from"../../chunks/Image.js";import"../../chunks/cjs.js";import"../../chunks/get-path-value.js";import"../../preact-jsx-runtime.js";import"../../chunks/icons/Add.js";import"../../i18n.js";import"../../chunks/vcomponent.js";import"../../chunks/image-params-keymap.js";import"../../signals.js";function d(){const t=b("commerce-assets-enabled");return t&&(typeof t=="string"&&t.toLowerCase()==="true"||typeof t=="boolean"&&t===!0)}function $(){return{quality:80,format:"webp"}}function p(t){let e=t;if(e.startsWith("//")){const{protocol:s}=window.location;console.log("protocol",s),e=s+e}return e}function f(t){return!!(typeof t=="string"?new URL(p(t)):t).pathname.startsWith("/adobe/assets/urn:aaid:aem")}function g(t,e,s={}){const r={...$(),...s},{format:i,crop:a,size:n,...o}=r,m=new URLSearchParams(o);if(a){const[h,w]=[a.xOrigin||0,a.yOrigin||0],[A,U]=[a.width||100,a.height||100],P=`${h}p,${w}p,${A}p,${U}p`;m.set("crop",P)}return n&&n.width&&n.height&&m.set("size",`${n.width},${n.height}`),`${t}/as/${e}.${i}?${m.toString()}`}function x(t,e,s={}){if(!d())return t;const r=new URL(p(t));if(!f(r))return t;const i=r.origin+r.pathname;return g(i,e,s)}function y(t){return e=>{const{wrapper:s,alias:c,params:r,imageProps:i,src:a}=t,n=s??document.createElement("div"),o=g(a||i.src,c,r);l.render(u,{...i,src:o,params:{width:r.width,crop:null,fit:null,auto:null}})(n),e.replaceWith(n)}}function D(t,e){function s(){const o=e.wrapper??document.createElement("div"),{imageProps:m}=e;l.render(u,m)(o),t.replaceWith(o)}if(!d()){s();return}const{imageProps:r,src:i,...a}=e,n=new URL(p(i??r.src));if(!f(n)){s();return}y({src:n.toString(),params:{width:r.width,height:r.height,...a.params},imageProps:r,alias:a.alias,wrapper:a.wrapper})(t)}export{g as generateAemAssetsOptimizedUrl,$ as getDefaultAemAssetsOptimizationParams,d as isAemAssetsEnabled,f as isAemAssetsUrl,y as makeAemAssetsImageSlot,x as tryGenerateAemAssetsOptimizedUrl,D as tryRenderAemAssetsImage};
//# sourceMappingURL=assets.js.map
