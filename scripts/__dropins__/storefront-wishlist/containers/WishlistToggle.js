/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as r}from"@dropins/tools/preact-jsx-runtime.js";import{useState as m,useCallback as P,useEffect as d}from"@dropins/tools/preact-compat.js";import{Button as b,Icon as h}from"@dropins/tools/components.js";import{events as a}from"@dropins/tools/event-bus.js";import{s as x,g as E,i as F,r as H}from"../chunks/removeProductsFromWishlist.js";import{c as L,a as T}from"../chunks/mergeWishlists.js";import{S as j}from"../chunks/HeartFilled.js";import{S as q}from"../chunks/Heart.js";import"@dropins/tools/fetch-graphql.js";import"@dropins/tools/lib.js";const R=({product:s,iconWishlisted:u,iconToWishlist:g,size:I,variant:v,disabled:p,labelToWishlist:k,labelWishlisted:W,onClick:w})=>{const[D,C]=m(x.authenticated),[c,n]=m(!1),[f,S]=m(null),{isGuestWishlistEnabled:U}=L.getConfig(),o=P(()=>{var e;const i=E(),t=(e=i==null?void 0:i.items)==null?void 0:e.find(l=>F(l,{sku:s.sku,optionUIDs:s.optionUIDs}));S(t??null),n(!!t)},[s.sku,s.optionUIDs]);d(()=>{o()},[o]),d(()=>{const i=l=>C(l),t=a.on("authenticated",i),e=a.on("wishlist/data",o);return()=>{t==null||t.off(),e==null||e.off()}},[o]);const y=async()=>{var i;c?(await H([f]),n(!1),a.emit("wishlist/alert",{action:"remove",item:f})):(await T([{sku:s.sku,quantity:1,optionsUIDs:s.optionUIDs??void 0,enteredOptions:(i=s.options)!=null&&i.items?s.options.items.filter(t=>t.selected).map(t=>({uid:t.uid,value:t.value})):void 0}]),n(!0),a.emit("wishlist/alert",{action:"add",item:{product:s}}))};return!D&&!U?null:r(b,{active:c,"data-testid":"wishlist-toggle",size:I??"medium",variant:v??"tertiary",disabled:p,icon:r(h,{source:g??q}),activeIcon:r(h,{source:u??j}),onClick:w??y,children:k,activeChildren:W})};export{R as WishlistToggle,R as default};
