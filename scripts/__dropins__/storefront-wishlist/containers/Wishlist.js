/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as n,jsxs as I,Fragment as B}from"@dropins/tools/preact-jsx-runtime.js";import*as W from"@dropins/tools/preact-compat.js";import{Suspense as H,lazy as t,useState as T,useCallback as x,useEffect as $,useMemo as O,Fragment as C}from"@dropins/tools/preact-compat.js";import{classes as L,isNumber as F,VComponent as M}from"@dropins/tools/lib.js";import{IllustratedMessage as z,Button as j,Icon as N,InLineAlert as U}from"@dropins/tools/components.js";import{S as q,a as G,W as J}from"../chunks/WishlistItem.js";import{s as w}from"../chunks/removeProductsFromWishlist.js";import{events as V}from"@dropins/tools/event-bus.js";import{g as K}from"../chunks/getWishlistById.js";import{useText as P,Text as k}from"@dropins/tools/i18n.js";import{a as Q,S as X}from"../chunks/HeartFilled.js";import{useCallback as R,useMemo as Y}from"@dropins/tools/preact-hooks.js";import"@dropins/tools/fetch-graphql.js";const b=o=>W.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o},W.createElement("path",{d:"M7.74512 9.87701L12.0001 14.132L16.2551 9.87701",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"square",strokeLinejoin:"round"})),Z=Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"})),tt=({className:o,children:i,ctaLinkURL:s,...c})=>{const u=P({emptyWishlist:"Wishlist.EmptyWishlist.heading",message:"Wishlist.EmptyWishlist.message",cta:"Wishlist.EmptyWishlist.cta"});return n("div",{...c,className:L(["wishlist-empty-wishlist",o]),children:n(z,{className:L(["wishlist-empty-wishlist__wrapper",o]),"data-testid":"wishlist-empty-wishlist",heading:u.emptyWishlist,icon:n(N,{className:"wishlist-empty-wishlist__icon",source:Q}),message:n("p",{children:u.message}),action:s?n(j,{"data-testid":"wishlist-empty-wishlist-button",size:"medium",variant:"primary",type:"submit",href:s,children:u.cta},"routeHome"):void 0})})},et=function(){const i=typeof document<"u"&&document.createElement("link").relList;return i&&i.supports&&i.supports("modulepreload")?"modulepreload":"preload"}(),it=function(o){return"/"+o},D={},e=function(i,s,c){let u=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),l=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));u=Promise.allSettled(s.map(h=>{if(h=it(h),h in D)return;D[h]=!0;const v=h.endsWith(".css"),f=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${f}`))return;const r=document.createElement("link");if(r.rel=v?"stylesheet":et,v||(r.as="script"),r.crossOrigin="",r.href=h,l&&r.setAttribute("nonce",l),document.head.appendChild(r),v)return new Promise((a,p)=>{r.addEventListener("load",a),r.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${h}`)))})}))}function m(d){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=d,window.dispatchEvent(l),!l.defaultPrevented)throw d}return u.then(d=>{for(const l of d||[])l.status==="rejected"&&m(l.reason);return i().catch(m)})},rt=o=>o.reduce((s,c)=>{if(!c)return s;if(typeof c=="string"&&(s+=` ${c}`),Array.isArray(c)){const[u,m]=c;u&&m&&(s+=` ${u}`)}return s},"").trim(),st={Add:t(()=>e(()=>import("../chunks/Add.js"),[])),Bulk:t(()=>e(()=>import("../chunks/Bulk.js"),[])),Burger:t(()=>e(()=>import("../chunks/Burger.js"),[])),Cart:t(()=>e(()=>import("../chunks/WishlistItem.js").then(o=>o.C),[])),Check:t(()=>e(()=>import("../chunks/Check.js"),[])),ChevronDown:t(()=>e(()=>Promise.resolve().then(()=>Z),void 0)),ChevronUp:t(()=>e(()=>import("../chunks/ChevronUp.js"),[])),ChevronRight:t(()=>e(()=>import("../chunks/ChevronRight.js"),[])),Close:t(()=>e(()=>import("../chunks/Close.js"),[])),Heart:t(()=>e(()=>import("../chunks/HeartFilled.js").then(o=>o.H),[])),Minus:t(()=>e(()=>import("../chunks/Minus.js"),[])),Placeholder:t(()=>e(()=>import("../chunks/Placeholder.js"),[])),PlaceholderFilled:t(()=>e(()=>import("../chunks/PlaceholderFilled.js"),[])),Search:t(()=>e(()=>import("../chunks/Search.js"),[])),SearchFilled:t(()=>e(()=>import("../chunks/SearchFilled.js"),[])),Sort:t(()=>e(()=>import("../chunks/Sort.js"),[])),Star:t(()=>e(()=>import("../chunks/Star.js"),[])),View:t(()=>e(()=>import("../chunks/View.js"),[])),User:t(()=>e(()=>import("../chunks/User.js"),[])),Warning:t(()=>e(()=>import("../chunks/Warning.js"),[])),Locker:t(()=>e(()=>import("../chunks/Locker.js"),[])),Wallet:t(()=>e(()=>import("../chunks/Wallet.js"),[])),Card:t(()=>e(()=>import("../chunks/Card.js"),[])),Order:t(()=>e(()=>import("../chunks/Order.js"),[])),Delivery:t(()=>e(()=>import("../chunks/Delivery.js"),[])),OrderError:t(()=>e(()=>import("../chunks/OrderError.js"),[])),OrderSuccess:t(()=>e(()=>import("../chunks/OrderSuccess.js"),[])),PaymentError:t(()=>e(()=>import("../chunks/PaymentError.js"),[])),CheckWithCircle:t(()=>e(()=>import("../chunks/CheckWithCircle.js"),[])),WarningWithCircle:t(()=>e(()=>import("../chunks/WarningWithCircle.js"),[])),WarningFilled:t(()=>e(()=>import("../chunks/WarningFilled.js"),[])),InfoFilled:t(()=>e(()=>import("../chunks/InfoFilled.js"),[])),HeartFilled:t(()=>e(()=>import("../chunks/HeartFilled.js").then(o=>o.b),[])),Trash:t(()=>e(()=>import("../chunks/WishlistItem.js").then(o=>o.T),[])),Eye:t(()=>e(()=>import("../chunks/Eye.js"),[])),EyeClose:t(()=>e(()=>import("../chunks/EyeClose.js"),[])),Date:t(()=>e(()=>import("../chunks/Date.js"),[])),AddressBook:t(()=>e(()=>import("../chunks/AddressBook.js"),[])),EmptyBox:t(()=>e(()=>import("../chunks/EmptyBox.js"),[])),Coupon:t(()=>e(()=>import("../chunks/Coupon.js"),[])),Gift:t(()=>e(()=>import("../chunks/Gift.js"),[])),GiftCard:t(()=>e(()=>import("../chunks/GiftCard.js"),[]))};function S({source:o,size:i="24",stroke:s="2",viewBox:c="0 0 24 24",className:u,...m}){const d=typeof o=="string"?st[o]:null,l={className:rt(["dropin-icon",`dropin-icon--shape-stroke-${s}`,u]),width:i,height:i,viewBox:c};return n(H,{fallback:n("svg",{...m,...l}),children:d?n(d,{...m,...l}):n(o,{...m,...l})})}const ot=({totalPages:o=10,currentPage:i=1,onChange:s,className:c,...u})=>{const m=P({backwardButton:"Dropin.Pagination.backwardButton.ariaLabel",forwardButton:"Dropin.Pagination.forwardButton.ariaLabel"}),d=R(()=>{const r=Math.min(i+1,o);s==null||s(r)},[i,s,o]),l=R(()=>{const r=Math.max(i-1,1);s==null||s(r)},[i,s]),h=R(r=>{F(r)&&(s==null||s(r))},[s]),v=R((r,a)=>{let p=[];const _=(E,A)=>{for(let g=E;g<=A;g++)p.push({page:g,isActive:g===r,label:g})};return a<=5?_(1,a):r<=2?(_(1,2),p.push({page:"ellipsis",isActive:!1,label:"..."}),_(a-1,a)):r>=a-3?_(a-4,a):(_(r-1,r),p.push({page:"ellipsis",isActive:!1,label:"..."}),_(a-1,a)),p},[]),f=Y(()=>v(i,o),[v,i,o]);return I("div",{...u,className:L(["dropin-pagination",c]),children:[n("button",{type:"button","data-testid":"prev-button","aria-label":m.backwardButton,disabled:i===1,onClick:l,className:L(["dropin-pagination-arrow","dropin-pagination-arrow--backward"]),children:n(S,{size:"24",source:b})}),n("ul",{className:"dropin-pagination_list",children:f.map((r,a)=>n("li",{"data-testid":`dropin-pagination_list-item--${r.page}`,className:L(["dropin-pagination_list-item",`dropin-pagination_list-item--${r.page}`,["dropin-pagination_list-item--active",r.isActive]]),children:n("button",{type:"button","data-testid":`set-page-button-${r.page}`,onClick:()=>h(r.page),children:r.label})},`${r.page}_${a}`))}),n("button",{type:"button","data-testid":"next-button","aria-label":m.forwardButton,disabled:i===o,onClick:d,className:L(["dropin-pagination-arrow","dropin-pagination-arrow--forward"]),children:n(S,{size:"24",source:b})})]})},At=({routeEmptyWishlistCTA:o,moveProdToCart:i,...s})=>{const[c,u]=T(null),[m,d]=T(w.authenticated),l=P({addHeading:"Wishlist.Alert.addProduct.heading",addMessage:"Wishlist.Alert.addProduct.message",removeHeading:"Wishlist.Alert.removeProduct.heading",removeMessage:"Wishlist.Alert.removeProduct.message",moveHeading:"Wishlist.Alert.moveToCart.heading",moveMessage:"Wishlist.Alert.moveToCart.message",viewWishlist:"Wishlist.Alert.viewWishlist"}),h=a=>d(a),[v,f]=T(null),r=x(a=>{const{action:p,item:_}=a,E=l[`${p}Heading`],A=l[`${p}Message`],g={add:X,remove:G,move:q};f(n(U,{"data-testid":"wishlist-alert",heading:E,description:A.replace("{product}",_.product.name),type:"success",icon:n(N,{source:g[p],size:"16"}),actionButtonPosition:"top",additionalActions:[{label:l.viewWishlist,onClick:()=>{}}]}))},[l]);return $(()=>{const a=V.on("authenticated",h),p=V.on("wishlist/update",E=>r(E)),_=V.on("wishlist/data",E=>{u(E)});return()=>{a==null||a.off(),_==null||_.off(),p==null||p.off()}},[r]),n(nt,{...s,wishlistData:c,wishlistAlert:v,routeEmptyWishlistCTA:o,moveProdToCart:i,isLoggedIn:m})},nt=({className:o,wishlistData:i,wishlistAlert:s,isLoggedIn:c,moveProdToCart:u,routeEmptyWishlistCTA:m,...d})=>{const[l,h]=T(s),v=P({wishlistHeading:"Wishlist.Wishlist.heading"}),f=O(()=>{var _;return((_=i==null?void 0:i.items)==null?void 0:_.length)>0?i.items.map(E=>{var A;return n(J,{initialData:E,moveProdToCart:u},(A=E.product)==null?void 0:A.sku)}):null},[i,u]);$(()=>{if(s){h(s);const _=setTimeout(()=>{h(null)},5e3);return()=>clearTimeout(_)}},[s]);const r=O(()=>l?n(M,{node:l,className:"wishlist-wishlist__alert"}):null,[l]),a=O(()=>{var E;if(!f)return null;const _=c?i==null?void 0:i.items_count:i.items.length;return n("div",{className:"wishlist-wishlist__heading","data-testid":"wishlist-heading-wrapper",children:n("div",{className:"wishlist-wishlist__heading-text","data-testid":"default-wishlist-heading",children:(E=v.wishlistHeading)==null?void 0:E.split(" {count}").map((A,g)=>{var y;return I(C,{children:[A,g===0&&n("span",{className:"wishlist-wishlist__heading-count","data-testid":"wishlist-heading-count",children:`${_} products`})]},((y=i==null?void 0:i.id)==null?void 0:y.toString())+g)})})})},[v,f,i]),p=O(()=>!f||!c||i.total_pages===1?null:n(ot,{currentPage:w.currentPage||1,onChange:_=>{K(w.wishlistId,_,w.pageSize||10).then(()=>{w.currentPage=_}).catch(E=>{console.error("Failed to fetch wishlist data:",E)})},totalPages:i.total_pages}),[f,c,i]);return I("div",{...d,className:L(["wishlist-wishlist",o]),children:[r,f?I(B,{children:[a,p,n("div",{className:"wishlist-wishlist__content",children:f})]}):n("div",{className:L(["wishlist-wishlist__content","wishlist-wishlist__content--empty"]),children:I("div",{children:[n(tt,{"data-testid":"empty-wishlist",ctaLinkURL:m==null?void 0:m()}),!c&&n(lt,{})]})})]})},lt=()=>I("div",{className:"wishlist-login__sign-in",children:[n("a",{"data-testid":"log-in-link",className:"wishlist-login__link",href:"/#",target:"_blank",rel:"noreferrer",children:n(k,{id:"Wishlist.Login.logIn"})}),n(k,{id:"Wishlist.Login.sync"})]});export{At as Wishlist,At as default};
