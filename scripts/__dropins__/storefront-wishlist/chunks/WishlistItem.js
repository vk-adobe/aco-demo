/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as s,Fragment as g,jsxs as f}from"@dropins/tools/preact-jsx-runtime.js";import{classes as n}from"@dropins/tools/lib.js";import{Price as w,Button as T,Icon as _,Image as E}from"@dropins/tools/components.js";import{useState as S}from"@dropins/tools/preact-compat.js";import{s as p,r as A}from"./removeProductsFromWishlist.js";import{events as b}from"@dropins/tools/event-bus.js";import{a as C,S as F}from"./Trash.js";import{useText as O}from"@dropins/tools/i18n.js";const k=({taxes:c,displayMode:r})=>s(g,{children:c.map((e,o)=>f("div",{"data-testid":`wishlist-product-item-tax-${o}`,className:"wishlist-product-item-tax",children:[s("span",{className:"wishlist-product-item-tax-label",children:e.label}),s(w,{className:"wishlist-product-item-tax-price",amount:e.money.value,currency:e.money.currency}),s("span",{className:"wishlist-product-item-tax-display-mode",children:r==="INCLUDING_FPT_AND_DESCRIPTION"?"incl.":"excl."})]},o))}),L=({className:c,item:r,onCartActionButtonClick:e,onTrashButtonClick:o,fixedProductTaxesEnabled:l,fixedProductTaxesEnabledDisplayInProductLists:a,...d})=>{var i,h,P,m,x,v,N,I,y;const t=O({cartActionBtn:"ProductItem.CartActionButton",trashActionBtn:"ProductItem.TrashActionButton"}),u=((h=(i=r==null?void 0:r.prices)==null?void 0:i.discount)==null?void 0:h.amountOff)!==0||((m=(P=r==null?void 0:r.prices)==null?void 0:P.discount)==null?void 0:m.percentOff)!==0;return s("div",{...d,className:n(["wishlist-product-item",c]),children:f("div",{className:"wishlist-product-item__content",children:[s("a",{className:"wishlist-product-item-image","data-testid":"wishlist-product-item-image",href:r==null?void 0:r.urlKey,children:s(G,{images:r!=null&&r.image?[r.image]:[]})}),f("div",{className:"wishlist-product-item__title","data-testid":"wishlist-product-item-header",children:[s("a",{className:"wishlist-product-item-name","data-testid":"wishlist-product-item-name",href:r==null?void 0:r.urlKey,children:r==null?void 0:r.name}),s(T,{"data-testid":"wishlist-product-item-remove-button",className:"wishlist-product-item-button__remove",variant:"tertiary",onClick:()=>o==null?void 0:o(),icon:s(_,{source:C,size:"24",stroke:"2",viewBox:"0 0 24 24","aria-label":t.trashActionBtn})}),s(w,{className:n(["wishlist-product-item-price",u?"strikeout":""]),"data-testid":"wishlist-product-item-price",amount:(x=r==null?void 0:r.prices)==null?void 0:x.regularPrice.value,currency:(v=r==null?void 0:r.prices)==null?void 0:v.regularPrice.currency}),u&&s(w,{className:"wishlist-product-item-discounted-price","data-testid":"wishlist-product-item-discounted-price",amount:(N=r==null?void 0:r.prices)==null?void 0:N.finalPrice.value,currency:(I=r==null?void 0:r.prices)==null?void 0:I.finalPrice.currency}),l&&(a==="INCLUDING_FPT_AND_DESCRIPTION"||a==="EXCLUDING_FPT_INCLUDING_DESCRIPTION_FINAL_PRICE")&&((y=r==null?void 0:r.prices)==null?void 0:y.fixedProductTaxes)&&s(k,{taxes:r.prices.fixedProductTaxes,displayMode:a})]}),s(T,{"data-testid":"wishlist-product-item-move-to-cart-button",size:"medium",type:"submit",icon:s(_,{source:F}),disabled:(r==null?void 0:r.stockStatus)!=="IN_STOCK","aria-label":t.cartActionBtn,onClick:()=>e==null?void 0:e(),children:t.cartActionBtn})]})})},G=({className:c,children:r,images:e,...o})=>{const[l,a]=S(0);return f(g,{children:[s("div",{...o,className:n(["image-carousel",c]),children:s("div",{className:n(["overflow-hidden relative max-w-[200px]",c]),children:e==null?void 0:e.map((d,t)=>t===l&&s(E,{className:"image-carousel-image",alt:d.alt,src:d.src}))})}),(e==null?void 0:e.length)>1&&s("div",{className:n(["absolute","image-switcher-area"]),children:e==null?void 0:e.map((d,t)=>s("span",{className:n(["image-switcher",l===t?"image-switcher-active":"image-switcher-inactive"]),onClick:u=>{a(t),u.stopPropagation()}},t))})]})},z=({initialData:c=null,moveProdToCart:r})=>{var l,a,d,t,u;if(!(c!=null&&c.product))return null;const e=async(i=!0)=>{try{return await A([c]),console.log(`Product ${c.product.sku} removed from wishlist!`),i&&b.emit("wishlist/alert",{action:"remove",item:c}),!0}catch(h){return console.error(`Product ${c.product.sku} could not be removed from wishlist`,h),!1}},o=async()=>{try{return await r([{sku:c.product.sku,quantity:1}]),console.log(`Product ${c.product.sku} successfully moved to cart ðŸ›’!`),b.emit("wishlist/alert",{action:"move",item:c}),await e(!1)}catch(i){return console.error("Cart creation/update failed: ",i),!1}};return s(L,{item:c.product,onCartActionButtonClick:o,onTrashButtonClick:e,fixedProductTaxesEnabled:((l=p.config)==null?void 0:l.fixedProductTaxesEnabled)??!1,fixedProductTaxesApply:((a=p.config)==null?void 0:a.fixedProductTaxesApply)??!1,fixedProductTaxesEnabledDisplayInProductLists:(d=p.config)==null?void 0:d.fixedProductTaxesEnabledDisplayInProductLists,fixedProductTaxesEnabledDisplayInProductView:(t=p.config)==null?void 0:t.fixedProductTaxesEnabledDisplayInProductView,fixedProductTaxesEnabledDisplayInSalesModules:(u=p.config)==null?void 0:u.fixedProductTaxesEnabledDisplayInSalesModules})};export{z as W};
