/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as m,jsx as e}from"@dropins/tools/preact-jsx-runtime.js";/* empty css                             */import{Card as k,Icon as l,Image as h}from"@dropins/tools/components.js";import"../chunks/TermsAndConditions.js";import{classes as O}from"@dropins/tools/lib.js";/* empty css                  */import{S as d}from"../chunks/OrderError.js";import{useText as p}from"@dropins/tools/i18n.js";/* empty css                      *//* empty css                  *//* empty css                       */import{events as S}from"@dropins/tools/event-bus.js";import{useState as v,useCallback as _,useEffect as g}from"@dropins/tools/preact-hooks.js";import"@dropins/tools/preact-compat.js";const N=({className:i,items:r,onRemoveOutOfStock:o,routeCart:u,...a})=>{const s=p({title:"Checkout.OutOfStock.title",message:"Checkout.OutOfStock.message",reviewCart:"Checkout.OutOfStock.actions.reviewCart",removeOutOfStock:"Checkout.OutOfStock.actions.removeOutOfStock"});return m(k,{className:O(["checkout-out-of-stock",i]),"data-testid":"checkout-out-of-stock",variant:"secondary",...a,children:[m("h4",{className:"checkout-out-of-stock__title",children:[e(l,{size:"16",source:d,stroke:"1"}),s.title]}),e("p",{className:"checkout-out-of-stock__message",children:s.message}),e("ol",{className:"checkout-out-of-stock__items",children:r.map(t=>e("li",{className:"checkout-out-of-stock__item","data-testid":"out-of-stock-item",children:e(h,{alt:t.image.alt,height:"100",loading:"eager",params:{width:100},src:t.image.src,width:"100"})},t.sku))}),m("div",{className:"checkout-out-of-stock__actions",children:[u&&e("a",{className:"checkout-out-of-stock__action","data-testid":"review-cart",href:u,children:s.reviewCart}),o&&e("button",{className:"checkout-out-of-stock__action","data-testid":"remove-out-of-stock",type:"button",onClick:o,children:s.removeOutOfStock})]})]})},A=({onCartProductsUpdate:i,routeCart:r})=>{const[o,u]=v([]),a=_(()=>{if(!i)return;const t=o.filter(c=>c.outOfStock).map(c=>({uid:c.uid,quantity:0}));i(t)},[o,i]);if(g(()=>{const t=S.on("cart/data",c=>{const f=(c==null?void 0:c.items)||[];u(f.filter(n=>n.outOfStock||n.insufficientQuantity))},{eager:!0});return()=>{t==null||t.off()}},[]),o.length===0)return null;const s=!o.some(t=>t.insufficientQuantity);return e(N,{items:o,routeCart:r==null?void 0:r(),onRemoveOutOfStock:s?a:void 0})};export{A as OutOfStock,A as default};
