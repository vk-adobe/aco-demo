{"version":3,"file":"PreAuthorizedDebitCanada.js","sources":["../../../../src/components/PreAuthorizedDebitCanada/PreAuthorizedDebitCanada.tsx"],"sourcesContent":["import { h, Fragment } from 'preact';\nimport UIElement from '../internal/UIElement/UIElement';\nimport { CoreProvider } from '../../core/Context/CoreProvider';\nimport { TxVariants } from '../tx-variants';\nimport PreAuthorizedDebitCanadaComponent from './components/PreAuthorizedDebitCanadaComponent';\nimport { SettlementInfo } from './components/SettlementInfo';\nimport RedirectButton from '../internal/RedirectButton';\nimport { payAmountLabel } from '../internal/PayButton';\n\nimport type { PreAuthorizedDebitCanadaConfiguration } from './types';\n\nexport class PreAuthorizedDebitCanada extends UIElement<PreAuthorizedDebitCanadaConfiguration> {\n    public static type = TxVariants.eft_directdebit_CA;\n\n    public override formatData() {\n        const recurringPayment = !!this.props.storedPaymentMethodId;\n\n        if (recurringPayment) {\n            return {\n                paymentMethod: {\n                    type: PreAuthorizedDebitCanada.type,\n                    storedPaymentMethodId: this.props.storedPaymentMethodId\n                }\n            };\n        }\n\n        return {\n            paymentMethod: {\n                type: PreAuthorizedDebitCanada.type,\n                ownerName: this.state.data.ownerName,\n                bankAccountNumber: this.state.data.bankAccountNumber,\n                bankCode: this.state.data.bankCode,\n                bankLocationId: this.state.data.bankLocationId\n            },\n            ...(this.state.storePaymentMethod && { storePaymentMethod: this.state.storePaymentMethod })\n        };\n    }\n\n    public override formatProps(props: PreAuthorizedDebitCanadaConfiguration): PreAuthorizedDebitCanadaConfiguration {\n        return {\n            enableStoreDetails: props.session?.configuration?.enableStoreDetails ?? props.enableStoreDetails,\n            ...props\n        };\n    }\n\n    public override get isValid(): boolean {\n        if (this.props.storedPaymentMethodId) {\n            return true;\n        }\n\n        return !!this.state.isValid;\n    }\n\n    public override get displayName(): string {\n        if (this.props.storedPaymentMethodId && this.props.lastFour) {\n            return `•••• ${this.props.lastFour}`;\n        }\n\n        return this.props.name;\n    }\n\n    public override get additionalInfo(): string {\n        return this.props.storedPaymentMethodId ? this.props.label : '';\n    }\n\n    render() {\n        return (\n            <CoreProvider i18n={this.props.i18n} loadingContext={this.props.loadingContext} resources={this.resources}>\n                {this.props.storedPaymentMethodId ? (\n                    <Fragment>\n                        <SettlementInfo />\n                        <RedirectButton\n                            showPayButton={this.props.showPayButton}\n                            icon={this.resources?.getImage({ imageFolder: 'components/' })(`bento_lock`)}\n                            label={payAmountLabel(this.props.i18n, this.props.amount)}\n                            name={this.displayName}\n                            amount={this.props.amount}\n                            payButton={this.payButton}\n                            onSubmit={this.submit}\n                            ref={ref => {\n                                this.componentRef = ref;\n                            }}\n                        />\n                    </Fragment>\n                ) : (\n                    <PreAuthorizedDebitCanadaComponent\n                        onChange={this.setState}\n                        payButton={this.payButton}\n                        showPayButton={this.props.showPayButton}\n                        placeholders={this.props.placeholders}\n                        setComponentRef={this.setComponentRef}\n                        showContextualElement={this.props.showContextualElement}\n                        enableStoreDetails={this.props.enableStoreDetails}\n                    />\n                )}\n            </CoreProvider>\n        );\n    }\n}\n\nexport default PreAuthorizedDebitCanada;\n"],"names":["PreAuthorizedDebitCanada","UIElement","formatData","this","props","storedPaymentMethodId","paymentMethod","type","_object_spread","ownerName","state","data","bankAccountNumber","bankCode","bankLocationId","storePaymentMethod","formatProps","enableStoreDetails","session","configuration","isValid","displayName","lastFour","name","additionalInfo","label","render","_this_resources","h","CoreProvider","i18n","loadingContext","resources","Fragment","SettlementInfo","RedirectButton","showPayButton","icon","getImage","imageFolder","payAmountLabel","amount","payButton","onSubmit","submit","ref","componentRef","PreAuthorizedDebitCanadaComponent","onChange","setState","placeholders","setComponentRef","showContextualElement","_define_property","TxVariants","eft_directdebit_CA"],"mappings":"q+BAWO,MAAMA,UAAiCC,EAG1BC,UAAAA,GAGZ,QAF2BC,KAAKC,MAAMC,sBAG3B,CACHC,cAAe,CACXC,KAAMP,EAAyBO,KAC/BF,sBAAuBF,KAAKC,MAAMC,wBAKvCG,EAAA,CACHF,cAAe,CACXC,KAAMP,EAAyBO,KAC/BE,UAAWN,KAAKO,MAAMC,KAAKF,UAC3BG,kBAAmBT,KAAKO,MAAMC,KAAKC,kBACnCC,SAAUV,KAAKO,MAAMC,KAAKE,SAC1BC,eAAgBX,KAAKO,MAAMC,KAAKG,iBAEhCX,KAAKO,MAAMK,oBAAsB,CAAEA,mBAAoBZ,KAAKO,MAAMK,oBAE9E,CAEgBC,WAAAA,CAAYZ,OAEAA,EAAAA,EAAAA,EADxB,OAAOI,EAAA,CACHS,2BAAoBb,EAAa,QAAbA,EAAAA,EAAMc,mBAANd,GAA4B,QAA5BA,EAAAA,EAAee,yBAAff,SAAAA,EAA8Ba,0BAA9Bb,IAAAA,EAAAA,EAAoDA,EAAMa,oBAC3Eb,EAEX,CAEA,WAAoBgB,GAChB,QAAIjB,KAAKC,MAAMC,yBAINF,KAAKO,MAAMU,OACxB,CAEA,eAAoBC,GAChB,OAAIlB,KAAKC,MAAMC,uBAAyBF,KAAKC,MAAMkB,SACxC,QAAQnB,KAAKC,MAAMkB,WAGvBnB,KAAKC,MAAMmB,IACtB,CAEA,kBAAoBC,GAChB,OAAOrB,KAAKC,MAAMC,sBAAwBF,KAAKC,MAAMqB,MAAQ,EACjE,CAEAC,MAAAA,GAQ8B,IAAAC,EAP1B,OACIC,EAACC,EAAAA,CAAaC,KAAM3B,KAAKC,MAAM0B,KAAMC,eAAgB5B,KAAKC,MAAM2B,eAAgBC,UAAW7B,KAAK6B,WAC3F7B,KAAKC,MAAMC,sBACRuB,EAACK,EAAAA,KACGL,EAACM,EAAAA,MACDN,EAACO,EAAAA,CACGC,cAAejC,KAAKC,MAAMgC,cAC1BC,KAAM,QAAAV,EAAAxB,KAAK6B,iBAAL,IAAAL,OAAA,EAAAA,EAAgBW,SAAS,CAAEC,YAAa,eAAxCZ,CAAyD,cAC/DF,MAAOe,EAAerC,KAAKC,MAAM0B,KAAM3B,KAAKC,MAAMqC,QAClDlB,KAAMpB,KAAKkB,YACXoB,OAAQtC,KAAKC,MAAMqC,OACnBC,UAAWvC,KAAKuC,UAChBC,SAAUxC,KAAKyC,OACfC,IAAKA,IACD1C,KAAK2C,aAAeD,CAAAA,KAKhCjB,EAACmB,EAAAA,CACGC,SAAU7C,KAAK8C,SACfP,UAAWvC,KAAKuC,UAChBN,cAAejC,KAAKC,MAAMgC,cAC1Bc,aAAc/C,KAAKC,MAAM8C,aACzBC,gBAAiBhD,KAAKgD,gBACtBC,sBAAuBjD,KAAKC,MAAMgD,sBAClCnC,mBAAoBd,KAAKC,MAAMa,qBAKnD,EArFAoC,EADSrD,EACKO,OAAO+C,EAAWC"}