{"version":3,"file":"postMessageValidation.js","sources":["../../../../../../../../../src/components/internal/SecuredFields/lib/CSF/utils/iframes/postMessageValidation.ts"],"sourcesContent":["import * as logger from '../../../utilities/logger';\n\nexport const originCheckPassed = (event: MessageEvent, pLoadingContext: string, pShowWarnings: boolean): boolean => {\n    const origin = event.origin; // || event.originalEvent.origin;\n\n    const isCheckoutUrl: number = pLoadingContext.indexOf('/checkoutshopper/');\n    let adyenDomain: string = isCheckoutUrl > -1 ? pLoadingContext.substring(0, isCheckoutUrl) : pLoadingContext;\n\n    // Strip trailing /\n    const lastCharIndex: number = adyenDomain.length - 1;\n    if (adyenDomain.charAt(lastCharIndex) === '/') {\n        adyenDomain = adyenDomain.substring(0, lastCharIndex);\n    }\n\n    if (origin !== adyenDomain) {\n        if (pShowWarnings) {\n            logger.warn(\n                'WARNING postMessageValidation: postMessage listener for iframe::origin mismatch!\\n Received message with origin:',\n                origin,\n                'but the only allowed origin for messages to CSF is',\n                adyenDomain,\n                '### event.data=',\n                event.data\n            );\n        }\n        return false;\n    }\n\n    return true;\n};\n\n// Catch webpack postMessages responses\nexport const isWebpackPostMsg = (event: MessageEvent): boolean =>\n    event.data && event.data.type && typeof event.data.type === 'string' && event.data.type.indexOf('webpack') > -1;\n\n// Catch ChromeVox postMessages responses\nexport const isChromeVoxPostMsg = (event: MessageEvent): boolean => event.data && typeof event.data === 'string' && event.data.indexOf('cvox') > -1;\n"],"names":["originCheckPassed","event","pLoadingContext","pShowWarnings","origin","isCheckoutUrl","indexOf","adyenDomain","substring","lastCharIndex","length","charAt","logger","data","isWebpackPostMsg","type","isChromeVoxPostMsg"],"mappings":"oDAEaA,MAAAA,EAAoB,CAACC,EAAqBC,EAAyBC,KAC5E,MAAMC,EAASH,EAAMG,OAEfC,EAAwBH,EAAgBI,QAAQ,qBACtD,IAAIC,EAAsBF,KAAqBH,EAAgBM,UAAU,EAAGH,GAAiBH,EAG7F,MAAMO,EAAwBF,EAAYG,OAAS,EAKnD,MAJ0C,MAAtCH,EAAYI,OAAOF,KACnBF,EAAcA,EAAYC,UAAU,EAAGC,IAGvCL,IAAWG,IACPJ,GACAS,EACI,mHACAR,EACA,qDACAG,EACA,kBACAN,EAAMY,OAGP,EAGJ,EAIEC,EAAoBb,GAC7BA,EAAMY,MAAQZ,EAAMY,KAAKE,MAAmC,iBAApBd,EAAMY,KAAKE,MAAqBd,EAAMY,KAAKE,KAAKT,QAAQ,YAAa,EAGpGU,EAAsBf,GAAiCA,EAAMY,MAA8B,iBAAfZ,EAAMY,MAAqBZ,EAAMY,KAAKP,QAAQ,SAAU"}