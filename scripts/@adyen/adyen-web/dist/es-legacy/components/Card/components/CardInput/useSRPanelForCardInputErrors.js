import{useState as r,useEffect as e}from"../../../../external/preact/hooks/dist/hooks.js";import t from"../../../../core/Errors/useSRPanelContext.js";import{mapFieldKey as o,handlePartialAddressMode as n,lookupBlurBasedErrors as s}from"./utils.js";import{usePrevious as l}from"../../../../utils/hookUtils.js";import{ERROR_ACTION_BLUR_SCENARIO as i,ERROR_ACTION_FOCUS_FIELD as u}from"../../../../core/Errors/constants.js";import{setFocusOnFirstField as a}from"./handlers.js";import{getArrayDifferences as c}from"../../../../utils/arrayUtils.js";function d(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function f(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})))),o.forEach((function(e){d(r,e,t[e])}))}return r}function p(r,e){if(null==r)return{};var t,o,n=function(r,e){if(null==r)return{};var t,o,n={},s=Object.keys(r);for(o=0;o<s.length;o++)t=s[o],e.indexOf(t)>=0||(n[t]=r[t]);return n}(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(o=0;o<s.length;o++)t=s[o],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(r,t)&&(n[t]=r[t])}return n}const b=({errors:d,props:b,isValidating:m,retrieveLayout:y,specifications:v,billingAddress:g,sfp:j})=>{var O;const{setSRMessagesFromObjects:S,setSRMessagesFromStrings:h,clearSRPanel:E,shouldMoveFocusSR:P}=t(),R=null==S?void 0:S({fieldTypeMappingFn:o}),k=n(b.billingAddressMode),[w,F]=r(null),M=l(w),x=f({},d,null===(O=j.current)||void 0===O?void 0:O.mapErrorsToValidationRuleResult());return e((()=>{try{var r;const{billingAddress:t}=x,o=f({},p(x,["billingAddress"]),t);var e;const n=null==R?void 0:R({errors:o,isValidating:m.current,layout:y(),countrySpecificLabels:null!==(e=v.getAddressLabelsForCountry(null==g?void 0:g.country))&&void 0!==e?e:null==k||null===(r=k.default)||void 0===r?void 0:r.labels}),l=null==n?void 0:n.currentErrorsSortedByLayout;switch(F(l),null==n?void 0:n.action){case u:P&&a(m.current,j,null==n?void 0:n.fieldToFocus),setTimeout((()=>{m.current=!1}),300);break;case i:{const r=c(l,M,"field"),e=null==r?void 0:r[0];if(e){const r=s(e.errorCode)?e.errorMessage:null;h(r)}else E();break}}}catch(r){}}),[d]),{sortedErrorList:w,previousSortedErrors:M,clearSRPanel:E}};export{b as default};
//# sourceMappingURL=useSRPanelForCardInputErrors.js.map
