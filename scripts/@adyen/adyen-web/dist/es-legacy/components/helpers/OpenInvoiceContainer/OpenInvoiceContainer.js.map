{"version":3,"file":"OpenInvoiceContainer.js","sources":["../../../../../src/components/helpers/OpenInvoiceContainer/OpenInvoiceContainer.tsx"],"sourcesContent":["import { h } from 'preact';\nimport UIElement from '../../internal/UIElement/UIElement';\nimport OpenInvoice from '../../internal/OpenInvoice';\nimport { CoreProvider } from '../../../core/Context/CoreProvider';\nimport SRPanelProvider from '../../../core/Errors/SRPanelProvider';\nimport { OpenInvoiceConfiguration } from './types';\n\nexport default class OpenInvoiceContainer extends UIElement<OpenInvoiceConfiguration> {\n    protected static defaultProps: Partial<OpenInvoiceConfiguration> = {\n        onChange: () => {},\n        data: { companyDetails: {}, personalDetails: {}, billingAddress: {}, deliveryAddress: {}, bankAccount: {} },\n        visibility: {\n            companyDetails: 'hidden',\n            personalDetails: 'editable',\n            billingAddress: 'editable',\n            deliveryAddress: 'editable',\n            bankAccount: 'hidden'\n        }\n    };\n\n    /**\n     * Returns whether the component state is valid or not\n     */\n    get isValid() {\n        return !!this.state.isValid;\n    }\n\n    /**\n     * Formats props on construction time\n     */\n    formatProps(props) {\n        const country = props.countryCode || props.data?.billingAddress?.countryCode;\n\n        return {\n            ...props,\n            allowedCountries: [country],\n            visibility: {\n                ...OpenInvoiceContainer.defaultProps.visibility,\n                ...props.visibility\n            },\n            data: {\n                ...props.data,\n                billingAddress: {\n                    ...props.data.billingAddress,\n                    country\n                },\n                deliveryAddress: {\n                    ...props.data.deliveryAddress,\n                    country\n                }\n            }\n        };\n    }\n\n    /**\n     * Formats the component data output\n     */\n    formatData() {\n        const { data = {} } = this.state;\n        const { companyDetails = {}, personalDetails = {}, billingAddress, deliveryAddress, bankAccount } = data;\n\n        return {\n            paymentMethod: {\n                type: this.constructor['type']\n            },\n            ...personalDetails,\n            ...companyDetails,\n            ...(bankAccount && {\n                bankAccount: {\n                    iban: bankAccount.ibanNumber,\n                    ownerName: bankAccount.ownerName,\n                    countryCode: bankAccount.countryCode\n                }\n            }),\n            ...(billingAddress && { billingAddress }),\n            ...((deliveryAddress || billingAddress) && { deliveryAddress: deliveryAddress || billingAddress })\n        };\n    }\n\n    render() {\n        return (\n            <CoreProvider i18n={this.props.i18n} loadingContext={this.props.loadingContext} resources={this.resources}>\n                <SRPanelProvider srPanel={this.props.modules.srPanel}>\n                    <OpenInvoice\n                        setComponentRef={this.setComponentRef}\n                        {...this.props}\n                        {...this.state}\n                        onChange={this.setState}\n                        onSubmit={this.submit}\n                        payButton={this.payButton}\n                    />\n                </SRPanelProvider>\n            </CoreProvider>\n        );\n    }\n}\n"],"names":["OpenInvoiceContainer","UIElement","isValid","this","state","formatProps","props","country","countryCode","data","billingAddress","_object_spread_props","allowedCountries","visibility","_object_spread","defaultProps","deliveryAddress","formatData","companyDetails","personalDetails","bankAccount","paymentMethod","type","constructor","iban","ibanNumber","ownerName","render","h","CoreProvider","i18n","loadingContext","resources","SRPanelProvider","srPanel","modules","OpenInvoice","setComponentRef","onChange","setState","onSubmit","submit","payButton","_define_property"],"mappings":"8mCAOe,MAAMA,UAA6BC,EAgB9C,WAAIC,GACA,QAASC,KAAKC,MAAMF,OACxB,CAKAG,WAAAA,CAAYC,OAC6BA,EAAAA,EAArC,MAAMC,EAAUD,EAAME,cAAeF,QAAAA,EAAAA,EAAMG,YAANH,IAAAA,GAAAA,QAAAA,EAAAA,EAAYI,sBAAZJ,IAAAA,OAAAA,EAAAA,EAA4BE,aAEjE,OAAOG,EACAL,EAAAA,CAAAA,EAAAA,GAAAA,CACHM,iBAAkB,CAACL,GACnBM,WAAYC,KACLd,EAAqBe,aAAaF,WAClCP,EAAMO,YAEbJ,KAAME,EAAAG,EAAA,CAAA,EACCR,EAAMG,MAAI,CACbC,eAAgBC,EACTL,EAAAA,CAAAA,EAAAA,EAAMG,KAAKC,gBAAc,CAC5BH,YAEJS,gBAAiBL,EACVL,EAAAA,CAAAA,EAAAA,EAAMG,KAAKO,iBAAe,CAC7BT,eAIhB,CAKAU,UAAAA,GACI,MAAMR,KAAEA,EAAO,IAAON,KAAKC,OACrBc,eAAEA,EAAiB,CAAA,EAAEC,gBAAEA,EAAkB,CAAE,EAAAT,eAAEA,EAAcM,gBAAEA,EAAeI,YAAEA,GAAgBX,EAEpG,OAAOK,EAAA,CACHO,cAAe,CACXC,KAAMnB,KAAKoB,YAAmB,OAE/BJ,EACAD,EACCE,GAAe,CACfA,YAAa,CACTI,KAAMJ,EAAYK,WAClBC,UAAWN,EAAYM,UACvBlB,YAAaY,EAAYZ,cAG7BE,GAAkB,CAAEA,mBACnBM,GAAmBN,IAAmB,CAAEM,gBAAiBA,GAAmBN,GAEzF,CAEAiB,MAAAA,GACI,OACIC,EAACC,EAAAA,CAAaC,KAAM3B,KAAKG,MAAMwB,KAAMC,eAAgB5B,KAAKG,MAAMyB,eAAgBC,UAAW7B,KAAK6B,WAC5FJ,EAACK,EAAAA,CAAgBC,QAAS/B,KAAKG,MAAM6B,QAAQD,SACzCN,EAACQ,EAAAA,EAAAA,EAAAA,CACGC,gBAAiBlC,KAAKkC,iBAClBlC,KAAKG,MACLH,KAAKC,OAAK,CACdkC,SAAUnC,KAAKoC,SACfC,SAAUrC,KAAKsC,OACfC,UAAWvC,KAAKuC,cAKpC,EAtFAC,EADiB3C,EACAe,eAAkD,CAC/DuB,SAAU,OACV7B,KAAM,CAAES,eAAgB,CAAC,EAAGC,gBAAiB,CAAC,EAAGT,eAAgB,CAAC,EAAGM,gBAAiB,CAAC,EAAGI,YAAa,CAAA,GACvGP,WAAY,CACRK,eAAgB,SAChBC,gBAAiB,WACjBT,eAAgB,WAChBM,gBAAiB,WACjBI,YAAa"}