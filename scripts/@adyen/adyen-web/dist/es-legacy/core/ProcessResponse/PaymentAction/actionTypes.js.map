{"version":3,"file":"actionTypes.js","sources":["../../../../../src/core/ProcessResponse/PaymentAction/actionTypes.ts"],"sourcesContent":["import { get3DS2FlowProps } from '../../../components/ThreeDS2/components/utils';\nimport uuid from '../../../utils/uuid';\nimport UIElement from '../../../components/internal/UIElement';\nimport type { PaymentAction } from '../../../types/global-types';\nimport type { IRegistry } from '../../core.registry';\nimport type { ICore } from '../../types';\n\nconst createComponent = (core: ICore, registry: IRegistry, componentType, props): UIElement => {\n    const Element = registry.getComponent(componentType);\n\n    if (!Element) {\n        throw Error(`Action Element of type ${componentType} not found in the registry`);\n    }\n\n    return new Element(core, { ...props, id: `${componentType}-${uuid()}` });\n};\n\nconst getActionHandler = statusType => {\n    return (core: ICore, registry: IRegistry, action: PaymentAction, props) => {\n        const config = {\n            ...props,\n            ...action,\n            onComplete: props.onAdditionalDetails,\n            onError: props.onError,\n            statusType,\n            originalAction: action\n        };\n\n        return createComponent(core, registry, action.paymentMethodType, config);\n    };\n};\n\nconst actionTypes = {\n    redirect: (core: ICore, registry, action: PaymentAction, props) => {\n        const config = {\n            ...props,\n            ...action,\n            statusType: 'redirect',\n            originalAction: action\n        };\n\n        return createComponent(core, registry, 'redirect', config);\n    },\n\n    threeDS2: (core: ICore, registry, action: PaymentAction, props) => {\n        const componentType = action.subtype === 'fingerprint' ? 'threeDS2DeviceFingerprint' : 'threeDS2Challenge';\n\n        /**\n         * NOTE: the isMDFlow prop comes from the options object, added within the MDFlow when it calls createFromAction(action, options) to initiate a 3DS2 component\n         * It replaces the useOriginalFlow config prop that the MDFlow used to pass when directly initiating the threeDS2Fingerprint or threeDS2Challenge components\n         */\n        const paymentData = action.subtype === 'fingerprint' || props.isMDFlow ? action.paymentData : action.authorisationToken;\n\n        const config = {\n            // Props common to both flows\n            core: core,\n            token: action.token,\n            paymentData,\n            onActionHandled: props.onActionHandled,\n            onComplete: props.isMDFlow ? props.onComplete : props.onAdditionalDetails,\n            onError: props.onError,\n            isDropin: !!props.isDropin,\n            loadingContext: props.loadingContext,\n            clientKey: props.clientKey,\n            paymentMethodType: props.paymentMethodType,\n            challengeWindowSize: props.challengeWindowSize, // always pass challengeWindowSize in case it's been set directly in the handleAction config object\n            isMDFlow: props.isMDFlow,\n            modules: {\n                analytics: props.modules?.analytics,\n                resources: props.modules?.resources\n            },\n\n            // Props unique to a particular flow\n            ...get3DS2FlowProps(action.subtype, props)\n        };\n\n        return createComponent(core, registry, componentType, config);\n    },\n\n    voucher: getActionHandler('custom'),\n    qrCode: getActionHandler('custom'),\n    await: getActionHandler('custom'),\n    bankTransfer: getActionHandler('custom'),\n    sdk: getActionHandler('custom')\n} as const;\n\nexport default actionTypes;\n"],"names":["createComponent","core","registry","componentType","props","Element","getComponent","Error","_object_spread_props","id","uuid","getActionHandler","statusType","action","config","onComplete","onAdditionalDetails","onError","originalAction","paymentMethodType","actionTypes","redirect","threeDS2","subtype","paymentData","isMDFlow","authorisationToken","_object_spread","token","onActionHandled","isDropin","loadingContext","clientKey","challengeWindowSize","modules","analytics","resources","get3DS2FlowProps","voucher","qrCode","await","bankTransfer","sdk"],"mappings":"y6BAOA,MAAMA,EAAkB,CAACC,EAAaC,EAAqBC,EAAeC,KACtE,MAAMC,EAAUH,EAASI,aAAaH,GAEtC,IAAKE,EACD,MAAME,MAAM,0BAA0BJ,+BAG1C,OAAO,IAAIE,EAAQJ,EAAMO,EAAKJ,EAAAA,CAAAA,EAAAA,GAAAA,CAAOK,GAAI,GAAGN,KAAiBO,UAG3DC,EAAmBC,GACd,CAACX,EAAaC,EAAqBW,EAAuBT,KAC7D,MAAMU,EAASN,OACRJ,EACAS,GAAAA,CACHE,WAAYX,EAAMY,oBAClBC,QAASb,EAAMa,QACfL,aACAM,eAAgBL,IAGpB,OAAOb,EAAgBC,EAAMC,EAAUW,EAAOM,kBAAmBL,EAAAA,EAInEM,EAAc,CAChBC,SAAU,CAACpB,EAAaC,EAAUW,EAAuBT,KACrD,MAAMU,EAASN,OACRJ,EACAS,GAAAA,CACHD,WAAY,WACZM,eAAgBL,IAGpB,OAAOb,EAAgBC,EAAMC,EAAU,WAAYY,EAAAA,EAGvDQ,SAAU,CAACrB,EAAaC,EAAUW,EAAuBT,SAwBlCA,EACAA,EAxBnB,MAAMD,EAAmC,gBAAnBU,EAAOU,QAA4B,4BAA8B,oBAMjFC,EAAiC,gBAAnBX,EAAOU,SAA6BnB,EAAMqB,SAAWZ,EAAOW,YAAcX,EAAOa,mBAE/FZ,EAASa,EAAA,CAEX1B,KAAMA,EACN2B,MAAOf,EAAOe,MACdJ,cACAK,gBAAiBzB,EAAMyB,gBACvBd,WAAYX,EAAMqB,SAAWrB,EAAMW,WAAaX,EAAMY,oBACtDC,QAASb,EAAMa,QACfa,WAAY1B,EAAM0B,SAClBC,eAAgB3B,EAAM2B,eACtBC,UAAW5B,EAAM4B,UACjBb,kBAAmBf,EAAMe,kBACzBc,oBAAqB7B,EAAM6B,oBAC3BR,SAAUrB,EAAMqB,SAChBS,QAAS,CACLC,UAAW/B,QAAAA,EAAAA,EAAM8B,eAAN9B,IAAAA,OAAAA,EAAAA,EAAe+B,UAC1BC,UAAWhC,QAAAA,EAAAA,EAAM8B,eAAN9B,IAAAA,OAAAA,EAAAA,EAAegC,YAI3BC,EAAiBxB,EAAOU,QAASnB,IAGxC,OAAOJ,EAAgBC,EAAMC,EAAUC,EAAeW,EAAAA,EAG1DwB,QAAS3B,EAAiB,UAC1B4B,OAAQ5B,EAAiB,UACzB6B,MAAO7B,EAAiB,UACxB8B,aAAc9B,EAAiB,UAC/B+B,IAAK/B,EAAiB"}