{"version":3,"file":"AmazonPayComponent.js","sources":["../../../../../src/components/AmazonPay/components/AmazonPayComponent.tsx"],"sourcesContent":["import { h } from 'preact';\nimport { useState, useEffect, useRef } from 'preact/hooks';\nimport Spinner from '../../internal/Spinner';\nimport { getAmazonPayUrl } from '../utils';\nimport { AmazonPayComponentProps } from '../types';\nimport AmazonPayButton from './AmazonPayButton';\nimport ChangePaymentDetailsButton from './ChangePaymentDetailsButton';\nimport OrderButton from './OrderButton';\nimport SignOutButton from './SignOutButton';\nimport Script from '../../../utils/Script';\n\nexport default function AmazonPayComponent(props: AmazonPayComponentProps) {\n    const [status, setStatus] = useState('pending');\n    const amazonPayButtonRef = useRef(null);\n    const orderButtonRef = useRef(null);\n\n    const handleLoad = () => {\n        setStatus('ready');\n    };\n\n    this.getSubmitFunction = () => {\n        if (amazonPayButtonRef.current && amazonPayButtonRef.current.initCheckout) return () => amazonPayButtonRef.current.initCheckout();\n        if (orderButtonRef.current && orderButtonRef.current.createOrder) return () => orderButtonRef.current.createOrder();\n    };\n\n    useEffect(() => {\n        const src = getAmazonPayUrl(props.configuration.region);\n        const script = new Script(src);\n        if (window.amazon) {\n            handleLoad();\n        } else {\n            void script.load().then(handleLoad);\n        }\n\n        return () => {\n            script.remove();\n        };\n    }, []);\n\n    if (status === 'pending') {\n        return (\n            <div className=\"adyen-checkout__amazonpay\">\n                <div className=\"adyen-checkout__amazonpay__status adyen-checkout__amazonpay__status--pending\">\n                    <Spinner />\n                </div>\n            </div>\n        );\n    }\n\n    if (props.showSignOutButton) {\n        return (\n            <div className=\"adyen-checkout__amazonpay\">\n                <SignOutButton amazonRef={window.amazon} onSignOut={props.onSignOut} />\n            </div>\n        );\n    }\n\n    if (props.amazonCheckoutSessionId) {\n        return (\n            <div className=\"adyen-checkout__amazonpay\">\n                {props.showOrderButton && (\n                    <OrderButton\n                        amazonCheckoutSessionId={props.amazonCheckoutSessionId}\n                        amount={props.amount}\n                        chargePermissionType={props.chargePermissionType}\n                        recurringMetadata={props.recurringMetadata}\n                        clientKey={props.clientKey}\n                        onError={props.onError}\n                        publicKeyId={props.configuration?.publicKeyId}\n                        region={props.configuration?.region}\n                        returnUrl={props.returnUrl}\n                        ref={orderButtonRef}\n                    />\n                )}\n\n                {props.showChangePaymentDetailsButton && (\n                    <ChangePaymentDetailsButton amazonCheckoutSessionId={props.amazonCheckoutSessionId} amazonRef={window.amazon} />\n                )}\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"adyen-checkout__amazonpay\">\n            <AmazonPayButton {...props} showPayButton={this.props.showPayButton} amazonRef={window.amazon} ref={amazonPayButtonRef} />\n        </div>\n    );\n}\n"],"names":["AmazonPayComponent","props","status","setStatus","useState","amazonPayButtonRef","useRef","orderButtonRef","handleLoad","this","getSubmitFunction","current","initCheckout","createOrder","useEffect","src","getAmazonPayUrl","configuration","region","script","Script","window","amazon","load","then","remove","h","div","className","Spinner","showSignOutButton","SignOutButton","amazonRef","onSignOut","amazonCheckoutSessionId","showOrderButton","OrderButton","amount","chargePermissionType","recurringMetadata","clientKey","onError","publicKeyId","returnUrl","ref","showChangePaymentDetailsButton","ChangePaymentDetailsButton","AmazonPayButton","showPayButton"],"mappings":"ucAWe,SAASA,EAAmBC,GACvC,MAAOC,EAAQC,GAAaC,EAAS,WAC/BC,EAAqBC,EAAO,MAC5BC,EAAiBD,EAAO,MAExBE,EAAa,KACfL,EAAU,QAAA,EAsBd,OAnBAM,KAAKC,kBAAoB,IACjBL,EAAmBM,SAAWN,EAAmBM,QAAQC,aAAqB,IAAMP,EAAmBM,QAAQC,eAC/GL,EAAeI,SAAWJ,EAAeI,QAAQE,YAAoB,IAAMN,EAAeI,QAAQE,mBAAtG,EAGJC,GAAU,KACN,MAAMC,EAAMC,EAAgBf,EAAMgB,cAAcC,QAC1CC,EAAS,IAAIC,EAAOL,GAO1B,OANIM,OAAOC,OACPd,IAEKW,EAAOI,OAAOC,KAAKhB,GAGrB,KACHW,EAAOM,QAAM,CACjB,GACD,IAEY,YAAXvB,EAEIwB,EAACC,MAAAA,CAAIC,UAAU,6BACXF,EAACC,MAAAA,CAAIC,UAAU,gFACXF,EAACG,EAAAA,QAMb5B,EAAM6B,kBAEFJ,EAACC,MAAAA,CAAIC,UAAU,6BACXF,EAACK,EAAAA,CAAcC,UAAWX,OAAOC,OAAQW,UAAWhC,EAAMgC,aAKlEhC,EAAMiC,wBAEFR,EAACC,MAAAA,CAAIC,UAAU,6BACV3B,EAAMkC,iBACHT,EAACU,EAAAA,CACGF,wBAAyBjC,EAAMiC,wBAC/BG,OAAQpC,EAAMoC,OACdC,qBAAsBrC,EAAMqC,qBAC5BC,kBAAmBtC,EAAMsC,kBACzBC,UAAWvC,EAAMuC,UACjBC,QAASxC,EAAMwC,QACfC,YAAazC,EAAMgB,eAAeyB,YAClCxB,OAAQjB,EAAMgB,eAAeC,OAC7ByB,UAAW1C,EAAM0C,UACjBC,IAAKrC,IAIZN,EAAM4C,gCACHnB,EAACoB,EAAAA,CAA2BZ,wBAAyBjC,EAAMiC,wBAAyBF,UAAWX,OAAOC,UAOlHI,EAACC,MAAAA,CAAIC,UAAU,6BACXF,EAACqB,EAAAA,IAAoB9C,EAAO+C,cAAevC,KAAKR,MAAM+C,cAAehB,UAAWX,OAAOC,OAAQsB,IAAKvC,IAGhH"}