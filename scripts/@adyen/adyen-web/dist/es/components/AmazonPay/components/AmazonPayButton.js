import{createElement as o}from"../../../external/preact/dist/preact.js";import{useState as t,useEffect as e}from"../../../external/preact/hooks/dist/hooks.js";import{getAmazonSignature as n}from"../services.js";import{getPayloadJSON as r,getAmazonPaySettings as a}from"../utils.js";import{useCoreContext as i}from"../../../core/Context/CoreProvider.js";function s(s){const{loadingContext:c}=i(),{amazonRef:u,configuration:l={}}=s,[m,h]=t(null),f=r(s),p=a(s),y=()=>{new Promise(s.onClick).then(this.initCheckout).catch((o=>{s.onError&&s.onError(o,this.componentRef)}))};return this.initCheckout=()=>{const o={payloadJSON:JSON.stringify(f),publicKeyId:l.publicKeyId,signature:m};u.Pay.initCheckout({...p,createCheckoutSessionConfig:o})},e((()=>{const{clientKey:o}=s;n(c,o,f).then((o=>{if(!o?.signature)return console.error("Could not get AmazonPay signature");h(o.signature),s.showPayButton&&u.Pay.renderButton("#amazonPayButton",p).onClick(y)})).catch((o=>{console.error(o),s.onError&&s.onError(o,this.componentRef)}))}),[]),s.showPayButton?o("div",{className:"adyen-checkout__amazonpay__button",id:"amazonPayButton"}):null}export{s as default};
//# sourceMappingURL=AmazonPayButton.js.map
