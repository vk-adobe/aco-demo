import{createElement as e}from"../../../../../../external/preact/dist/preact.js";import{useState as t,useRef as r,useCallback as o,useEffect as s}from"../../../../../../external/preact/hooks/dist/hooks.js";import{otpValidationRules as a}from"./validate.js";import n from"./CtPResendOtpLink.js";import l from"../../../context/useClickToPayContext.js";import{useCoreContext as i}from"../../../../../../core/Context/CoreProvider.js";import d from"../../../../../../utils/useForm/useForm.js";import p from"../../../../FormFields/Field/Field.js";import c from"../../../../FormFields/InputText.js";const u=u=>{const{i18n:m}=i(),{configuration:{disableOtpAutoFocus:f}}=l(),[C,g]=t(null),{handleChangeFor:F,data:h,triggerValidation:j,valid:k,errors:v,isValid:b,setData:x}=d({schema:["otp"],rules:a}),P=r({validateInput:null}),E=r(null),[I,R]=t(!1),y=o((()=>{R(!0),j()}),[j]);s((()=>{h.otp&&R(!0)}),[h.otp]),s((()=>{!f&&E.current&&E.current.focus()}),[E.current,f]),s((()=>{P.current.validateInput=y,u.onSetInputHandlers(P.current)}),[y,u.onSetInputHandlers]);const V=o((()=>{x("otp",""),g(null),f||E.current.focus(),u.onResendCode()}),[u.onResendCode,E.current,f]),_=o((e=>{const t=m.get(`ctp.errors.${e}`);t&&g(t)}),[m]),w=o((e=>{"Enter"===e.key&&u.onPressEnter()}),[u.onPressEnter]);return s((()=>{u.onChange({data:h,valid:k,errors:v,isValid:b})}),[h,k,v]),e("div",{className:"adyen-checkout-ctp__otp-field-wrapper"},e(p,{name:"oneTimePassword",label:m.get("ctp.otp.fieldLabel"),errorMessage:I?C||u.errorMessage||!!v.otp:null,classNameModifiers:["otp"]},e(c,{name:"otp",autocorrect:"off",spellcheck:!1,value:h.otp,disabled:u.disabled,onInput:F("otp","input"),onBlur:F("otp","blur"),onKeyPress:w,setRef:e=>{E.current=e}})),e("div",{className:"adyen-checkout-ctp__otp-resend-code-wrapper"},e(n,{disabled:u.isValidatingOtp,onError:_,onResendCode:V})))};export{u as default};
//# sourceMappingURL=CtPOneTimePasswordInput.js.map
